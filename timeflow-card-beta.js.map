{"version":3,"file":"timeflow-card-beta.js","sources":["node_modules/tslib/tslib.es6.js","node_modules/@lit/reactive-element/css-tag.js","node_modules/@lit/reactive-element/reactive-element.js","node_modules/lit-html/lit-html.js","node_modules/lit-element/lit-element.js","node_modules/@lit/reactive-element/decorators/property.js","node_modules/@lit/reactive-element/decorators/state.js","src/services/Timer.ts","src/utils/DateParser.ts","src/utils/ConfigValidator.ts","src/services/TemplateService.ts","src/services/CountdownService.ts","src/utils/StyleManager.ts","node_modules/lit-html/directive.js","src/utils/ActionHandler.ts","src/utils/ErrorDisplay.ts","src/components/TimeFlowCard.ts","src/components/ProgressCircle.ts","src/index.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1]),t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e;const r=h.fromAttribute(s,t.type);this[e]=r??this._$Ej?.get(e)??r,this._$Em=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.1\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,e=\"$lit$\",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=\"?\"+h,n=`<${o}>`,r=document,l=()=>r.createComment(\"\"),c=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a=Array.isArray,u=t=>a(t)||\"function\"==typeof t?.[Symbol.iterator],d=\"[ \\t\\n\\f\\r]\",f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\\\s\"'>=/]+)(${d}*=${d}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),p=/'/g,g=/\"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==s?s.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?\"!--\"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp(\"</\"+u[2],\"g\")),c=m):void 0!==u[3]&&(c=m):c===m?\">\"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'\"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x)}return[P(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:\".\"===e[1]?H:\"?\"===e[1]?I:\"@\"===e[1]?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:\"\";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(8===r.nodeType)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){const s=r.createElement(\"template\");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(\"3.3.1\");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h};export{Z as _$LH,x as html,w as mathml,T as noChange,E as nothing,B as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.1\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","import{defaultConverter as t,notEqual as e}from\"../reactive-element.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const o={attribute:!0,type:String,converter:t,reflect:!1,hasChanged:e},r=(t=o,e,r)=>{const{kind:n,metadata:i}=r;let s=globalThis.litPropertyMetadata.get(i);if(void 0===s&&globalThis.litPropertyMetadata.set(i,s=new Map),\"setter\"===n&&((t=Object.create(t)).wrapped=!0),s.set(r.name,t),\"accessor\"===n){const{name:o}=r;return{set(r){const n=e.get.call(this);e.set.call(this,r),this.requestUpdate(o,n,t)},init(e){return void 0!==e&&this.C(o,void 0,t,e),e}}}if(\"setter\"===n){const{name:o}=r;return function(r){const n=this[o];e.call(this,r),this.requestUpdate(o,n,t)}}throw Error(\"Unsupported decorator location: \"+n)};function n(t){return(e,o)=>\"object\"==typeof o?r(t,e,o):((t,e,o)=>{const r=e.hasOwnProperty(o);return e.constructor.createProperty(o,t),r?Object.getOwnPropertyDescriptor(e,o):void 0})(t,e,o)}export{n as property,r as standardProperty};\n//# sourceMappingURL=property.js.map\n","import{property as t}from\"./property.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function r(r){return t({...r,state:!0,attribute:!1})}export{r as state};\n//# sourceMappingURL=state.js.map\n","import { HomeAssistant } from '../types/index';\n\nexport interface TimerData {\n  isActive: boolean;\n  isPaused: boolean;\n  duration: number; // in seconds\n  remaining: number; // in seconds\n  finishesAt: Date | null;\n  progress: number; // 0-100\n  // NEW: Alexa-specific properties\n  isAlexaTimer?: boolean;\n  alexaDevice?: string;\n  timerLabel?: string;\n}\n\n/**\n * TimerEntityService - Enhanced with Amazon Alexa Timer support\n * Handles Home Assistant timer entity integration including Alexa Media Player timers\n */\nexport class TimerEntityService {\n  \n  /**\n   * Checks if an entity ID is a timer entity (including Alexa timers)\n   * @param entityId - Entity ID to check\n   * @returns boolean - Whether the entity is a timer\n   */\n  static isTimerEntity(entityId: string): boolean {\n    if (!entityId) return false;\n    \n    // Standard HA timers\n    if (entityId.startsWith('timer.')) return true;\n    \n    // Alexa Media Player timer sensors\n    if (entityId.includes('_next_timer') || \n        entityId.includes('alexa_timer') || \n        (entityId.startsWith('sensor.') && entityId.includes('timer'))) {\n      return true;\n    }\n    \n    return false;\n  }\n\n  /**\n   * Checks if entity is an Alexa timer specifically\n   * @param entityId - Entity ID to check\n   * @returns boolean - Whether this is an Alexa timer\n   */\n  static isAlexaTimer(entityId: string): boolean {\n    return entityId.includes('_next_timer') || \n           entityId.includes('alexa_timer') || \n           (entityId.startsWith('sensor.') && entityId.includes('alexa') && entityId.includes('timer'));\n  }\n\n  /**\n   * Gets timer data from a Home Assistant timer entity (including Alexa timers)\n   * @param entityId - Timer entity ID\n   * @param hass - Home Assistant object\n   * @returns TimerData object with timer information\n   */\n  static getTimerData(entityId: string, hass: HomeAssistant): TimerData | null {\n    if (!hass || !entityId || !this.isTimerEntity(entityId)) {\n      return null;\n    }\n\n    const entity = hass.states[entityId];\n    if (!entity) {\n      return null;\n    }\n\n    // Handle Alexa timers differently\n    if (this.isAlexaTimer(entityId)) {\n      return this.getAlexaTimerData(entityId, entity, hass);\n    }\n\n    // Handle standard HA timers (existing logic)\n    return this.getStandardTimerData(entityId, entity);\n  }\n/**\n * Handles Alexa timer data extraction\n * @param entityId - Alexa timer entity ID\n * @param entity - Entity state object\n * @param hass - Home Assistant object\n * @returns TimerData for Alexa timer\n */\nprivate static getAlexaTimerData(entityId: string, entity: any, hass: HomeAssistant): TimerData | null {\n  const state = entity.state;\n  const attributes = entity.attributes;\n\n  // Alexa timers might be stored as timestamps or duration strings\n  let remaining = 0;\n  let duration = 0;\n  let finishesAt: Date | null = null;\n  let isActive = false;\n  \n  // Handle different Alexa timer formats\n  if (state && state !== 'unavailable' && state !== 'unknown') {\n    // Case 1: State is a timestamp (end time)\n    if (this.isISOTimestamp(state)) {\n      finishesAt = new Date(state);\n      if (!isNaN(finishesAt.getTime())) {\n        const now = Date.now();\n        remaining = Math.max(0, Math.floor((finishesAt.getTime() - now) / 1000));\n        isActive = remaining > 0;\n      }\n    }\n    // Case 2: State is duration in seconds\n    else if (!isNaN(parseFloat(state))) {\n      remaining = Math.max(0, parseFloat(state));\n      isActive = remaining > 0;\n    }\n    // Case 3: State is duration string (HH:MM:SS)\n    else if (typeof state === 'string' && state.includes(':')) {\n      remaining = this.parseDuration(state);\n      isActive = remaining > 0;\n    }\n  }\n\n  // Try to get duration from attributes\n  let hasOriginalDuration = false;\n  if (attributes.original_duration) {\n    duration = this.parseDuration(attributes.original_duration);\n    hasOriginalDuration = true;\n  } else if (attributes.duration) {\n    duration = this.parseDuration(attributes.duration);\n    hasOriginalDuration = true;\n  } else {\n    // If no original duration, we can't calculate meaningful progress\n    // For display purposes, we'll use remaining as duration, but handle progress specially\n    duration = remaining > 0 ? remaining : 0;\n    hasOriginalDuration = false;\n  }\n\n  // Calculate progress - FIXED LOGIC\n  let progress = 0;\n  if (hasOriginalDuration && duration > 0) {\n    // We have a real original duration, calculate normal progress\n    if (isActive) {\n      const elapsed = duration - remaining;\n      progress = Math.min(100, Math.max(0, (elapsed / duration) * 100));\n    } else if (remaining === 0) {\n      progress = 100; // Timer finished\n    }\n  } else {\n    // No original duration available - use time-based progress estimation\n    if (isActive && remaining > 0) {\n      // For active timers without original duration, show progress based on a reasonable assumption\n      // We'll show progress as if this is a \"medium\" timer to give visual feedback\n      // This is imperfect but better than showing 0% progress\n      const assumedTotalTime = Math.max(remaining * 2, 300); // Assume at least 5 minutes or double remaining\n      const elapsed = assumedTotalTime - remaining;\n      progress = Math.min(100, Math.max(0, (elapsed / assumedTotalTime) * 100));\n    } else if (!isActive && remaining === 0) {\n      progress = 100; // Timer finished\n    } else {\n      progress = 0; // Timer not active\n    }\n  }\n\n  // Extract Alexa-specific info\n  const alexaDevice = this.extractAlexaDevice(entityId, attributes);\n  const timerLabel = attributes.friendly_name || attributes.timer_label || this.formatAlexaTimerName(entityId);\n\n  return {\n    isActive,\n    isPaused: false, // Alexa timers don't typically pause\n    duration,\n    remaining,\n    finishesAt,\n    progress,\n    isAlexaTimer: true,\n    alexaDevice,\n    timerLabel\n  };\n}\n\n  /**\n   * Handles standard HA timer data extraction (existing logic)\n   * @param entityId - Timer entity ID\n   * @param entity - Entity state object\n   * @returns TimerData for standard timer\n   */\n  private static getStandardTimerData(entityId: string, entity: any): TimerData | null {\n    const state = entity.state;\n    const attributes = entity.attributes;\n\n    // Timer states: idle, active, paused\n    const isActive = state === 'active';\n    const isPaused = state === 'paused';\n    const isIdle = state === 'idle';\n\n    // Get duration from attributes (in seconds or HH:MM:SS format)\n    let duration = 0;\n    if (attributes.duration) {\n      duration = this.parseDuration(attributes.duration);\n    }\n\n    // Calculate remaining time\n    let remaining = 0;\n    let finishesAt: Date | null = null;\n\n    if (isActive || isPaused) {\n      if (attributes.finishes_at) {\n        // Parse finishes_at timestamp\n        finishesAt = new Date(attributes.finishes_at);\n        if (!isNaN(finishesAt.getTime())) {\n          remaining = Math.max(0, Math.floor((finishesAt.getTime() - Date.now()) / 1000));\n        }\n      } else if (attributes.remaining) {\n        // Fallback to remaining attribute if available\n        remaining = this.parseDuration(attributes.remaining);\n      }\n    }\n\n    // Calculate progress (0-100)\n    let progress = 0;\n    if (duration > 0) {\n      if (isIdle) {\n        progress = 0;\n      } else {\n        const elapsed = duration - remaining;\n        progress = Math.min(100, Math.max(0, (elapsed / duration) * 100));\n      }\n    }\n\n    return {\n      isActive,\n      isPaused,\n      duration,\n      remaining,\n      finishesAt,\n      progress,\n      isAlexaTimer: false\n    };\n  }\n\n  /**\n   * Checks if a string is an ISO timestamp\n   * @param str - String to check\n   * @returns boolean - Whether string is ISO timestamp\n   */\n  private static isISOTimestamp(str: string): boolean {\n    // Check for ISO 8601 format\n    const isoRegex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?([+-]\\d{2}:\\d{2}|Z)?$/;\n    return isoRegex.test(str);\n  }\n\n  /**\n   * Extracts Alexa device name from entity ID or attributes\n   * @param entityId - Entity ID\n   * @param attributes - Entity attributes\n   * @returns string - Device name\n   */\n  private static extractAlexaDevice(entityId: string, attributes: any): string {\n    // Try to extract from entity ID\n    if (entityId.includes('echo')) {\n      const match = entityId.match(/echo[^_]*(?:_\\w+)*/);\n      if (match) return match[0].replace(/_/g, ' ');\n    }\n    \n    // Try from attributes\n    if (attributes.device_name) return attributes.device_name;\n    if (attributes.device) return attributes.device;\n    \n    // Fallback\n    return 'Alexa Device';\n  }\n\n  /**\n   * Formats Alexa timer name from entity ID\n   * @param entityId - Entity ID\n   * @returns string - Formatted name\n   */\n  private static formatAlexaTimerName(entityId: string): string {\n    return entityId\n      .replace(/^sensor\\./, '')\n      .replace(/_next_timer$/, '')\n      .replace(/_timer$/, '')\n      .replace(/_/g, ' ')\n      .replace(/\\b\\w/g, l => l.toUpperCase());\n  }\n\n  /**\n   * Parses duration from various formats (seconds, HH:MM:SS, etc.)\n   * @param duration - Duration value to parse\n   * @returns number - Duration in seconds\n   */\n  private static parseDuration(duration: any): number {\n    if (typeof duration === 'number') {\n      return duration;\n    }\n\n    if (typeof duration !== 'string') {\n      return 0;\n    }\n\n    // Handle HH:MM:SS format\n    if (duration.includes(':')) {\n      const parts = duration.split(':').map(Number);\n      if (parts.length === 3) {\n        // HH:MM:SS\n        return parts[0] * 3600 + parts[1] * 60 + parts[2];\n      } else if (parts.length === 2) {\n        // MM:SS\n        return parts[0] * 60 + parts[1];\n      }\n    }\n\n    // Try to parse as number (seconds)\n    const seconds = parseFloat(duration);\n    return isNaN(seconds) ? 0 : seconds;\n  }\n\n  /**\n   * Formats remaining time as human-readable string\n   * @param remaining - Remaining time in seconds\n   * @param showSeconds - Whether to include seconds in output\n   * @returns string - Formatted time string\n   */\n  static formatRemainingTime(remaining: number, showSeconds: boolean = true): string {\n    if (remaining <= 0) {\n      return '0:00';\n    }\n\n    const hours = Math.floor(remaining / 3600);\n    const minutes = Math.floor((remaining % 3600) / 60);\n    const seconds = Math.floor(remaining % 60);\n\n    if (hours > 0) {\n      if (showSeconds) {\n        return `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n      } else {\n        return `${hours}:${minutes.toString().padStart(2, '0')}`;\n      }\n    } else {\n      if (showSeconds) {\n        return `${minutes}:${seconds.toString().padStart(2, '0')}`;\n      } else {\n        return `${minutes}m`;\n      }\n    }\n  }\n\n  /**\n   * Gets appropriate title text for timer entity (enhanced for Alexa)\n   * @param entityId - Timer entity ID\n   * @param hass - Home Assistant object\n   * @param customTitle - Custom title override\n   * @returns string - Title text\n   */\n  static getTimerTitle(entityId: string, hass: HomeAssistant, customTitle?: string): string {\n    if (customTitle) {\n      return customTitle;\n    }\n\n    if (!hass || !entityId) {\n      return 'Timer';\n    }\n\n    const entity = hass.states[entityId];\n    if (!entity) {\n      return 'Timer';\n    }\n\n    // Handle Alexa timers\n    if (this.isAlexaTimer(entityId)) {\n      const timerData = this.getAlexaTimerData(entityId, entity, hass);\n      if (timerData?.timerLabel) {\n        return timerData.timerLabel;\n      }\n      return this.formatAlexaTimerName(entityId);\n    }\n\n    // Use friendly name or fall back to entity ID\n    return entity.attributes.friendly_name || entityId.replace('timer.', '').replace(/_/g, ' ');\n  }\n\n  /**\n   * Gets appropriate subtitle text for timer entity (enhanced for Alexa)\n   * @param timerData - Timer data object\n   * @param showSeconds - Whether to show seconds in remaining time\n   * @returns string - Subtitle text\n   */\n  static getTimerSubtitle(timerData: TimerData, showSeconds: boolean = true): string {\n    if (!timerData) {\n      return 'Timer not found';\n    }\n\n    // Handle Alexa timers\n    if (timerData.isAlexaTimer) {\n      if (timerData.isActive && timerData.remaining > 0) {\n        const remainingText = this.formatRemainingTime(timerData.remaining, showSeconds);\n        return `${remainingText} remaining${timerData.alexaDevice ? ` on ${timerData.alexaDevice}` : ''}`;\n      } else if (timerData.remaining === 0 && timerData.progress >= 100) {\n        return `Timer finished${timerData.alexaDevice ? ` on ${timerData.alexaDevice}` : ''}`;\n      } else {\n        return `Timer ready${timerData.alexaDevice ? ` on ${timerData.alexaDevice}` : ''}`;\n      }\n    }\n\n    // Handle standard HA timers\n    if (timerData.isActive) {\n      const remainingText = this.formatRemainingTime(timerData.remaining, showSeconds);\n      return `${remainingText} remaining`;\n    } else if (timerData.isPaused) {\n      const remainingText = this.formatRemainingTime(timerData.remaining, showSeconds);\n      return `Paused - ${remainingText} left`;\n    } else {\n      // Idle state\n      if (timerData.duration > 0) {\n        const durationText = this.formatRemainingTime(timerData.duration, showSeconds);\n        return `Ready - ${durationText}`;\n      } else {\n        return 'Timer ready';\n      }\n    }\n  }\n\n  /**\n   * Checks if timer is expired/finished (enhanced for Alexa)\n   * @param timerData - Timer data object\n   * @returns boolean - Whether timer is expired\n   */\n  static isTimerExpired(timerData: TimerData): boolean {\n    if (!timerData) return false;\n    \n    // For Alexa timers, check if remaining time is 0 and progress is 100%\n    if (timerData.isAlexaTimer) {\n      return timerData.remaining === 0 && timerData.progress >= 100;\n    }\n    \n    // For standard timers\n    return !timerData.isActive && !timerData.isPaused && timerData.progress >= 100;\n  }\n\n  /**\n   * Gets timer state color based on current state (enhanced for Alexa)\n   * @param timerData - Timer data object\n   * @param defaultColor - Default color to use\n   * @returns string - Color value\n   */\n  static getTimerStateColor(timerData: TimerData, defaultColor: string = '#4caf50'): string {\n    if (!timerData) {\n      return defaultColor;\n    }\n\n    // Alexa-specific coloring\n    if (timerData.isAlexaTimer) {\n      if (timerData.isActive && timerData.remaining > 0) {\n        return '#00d4ff'; // Alexa blue for active\n      } else if (this.isTimerExpired(timerData)) {\n        return '#ff4444'; // Red for expired\n      } else {\n        return '#888888'; // Gray for inactive\n      }\n    }\n\n    // Standard timer coloring\n    if (timerData.isActive) {\n      return '#4caf50'; // Green for active\n    } else if (timerData.isPaused) {\n      return '#ff9800'; // Orange for paused\n    } else if (this.isTimerExpired(timerData)) {\n      return '#f44336'; // Red for expired\n    } else {\n      return '#9e9e9e'; // Gray for idle\n    }\n  }\n\n  /**\n   * AUTO-DISCOVERY: Attempts to find Alexa timer entities in Home Assistant\n   * @param hass - Home Assistant object\n   * @returns string[] - Array of potential Alexa timer entity IDs\n   */\n  static discoverAlexaTimers(hass: HomeAssistant): string[] {\n    if (!hass || !hass.states) return [];\n    \n    const alexaTimers: string[] = [];\n    \n    for (const entityId in hass.states) {\n      if (this.isAlexaTimer(entityId)) {\n        const entity = hass.states[entityId];\n        // Only include if the entity has a meaningful state\n        if (entity.state && \n            entity.state !== 'unavailable' && \n            entity.state !== 'unknown' && \n            entity.state !== 'none') {\n          alexaTimers.push(entityId);\n        }\n      }\n    }\n    \n    return alexaTimers;\n  }\n}","/**\n * DateParser - Enhanced date parsing utility with a more streamlined fallback system\n * Handles cross-browser compatibility and edge cases for date string parsing\n */\nexport class DateParser {\n  /**\n   * Main entry point for date parsing with a hybrid approach\n   * @param {string} dateString - ISO date string to parse\n   * @returns {number} - Unix timestamp in milliseconds\n   */\n  static parseISODate(dateString: string): number {\n    // First, try a robust manual parsing for common ISO formats.\n    // This is more consistent across browsers than new Date().\n    try {\n      const manualResult = this.parseISODateManual(dateString);\n      if (!isNaN(manualResult)) {\n        return manualResult;\n      }\n    } catch (e) {\n      // Fall through to other methods if manual parsing fails\n    }\n\n    // Second, try the native Date constructor, which can handle more formats.\n    const nativeResult = new Date(dateString);\n    if (!isNaN(nativeResult.getTime()) && this.isValidDateResult(nativeResult, dateString)) {\n      return nativeResult.getTime();\n    }\n    \n    // If all else fails, use the final fallback.\n    return this.parseISODateFallback(dateString);\n  }\n\n  /**\n   * Validates that a parsed date result is reasonable\n   * @param {Date} dateObj - Parsed date object\n   * @param {string} originalString - Original date string\n   * @returns {boolean} - Whether the date is valid\n   */\n  static isValidDateResult(dateObj: Date, originalString: string): boolean {\n    const timestamp = dateObj.getTime();\n    \n    // Check for reasonable date range (1970-2100)\n    const minTimestamp = new Date('1970-01-01').getTime();\n    const maxTimestamp = new Date('2100-12-31').getTime();\n    \n    if (timestamp < minTimestamp || timestamp > maxTimestamp) {\n      return false;\n    }\n    \n    // Check for February 29th in non-leap years\n    if (typeof originalString === 'string' && originalString.includes('02-29')) {\n      const year = dateObj.getFullYear();\n      if (!this.isLeapYear(year)) {\n        return false;\n      }\n    }\n    \n    return true;\n  }\n\n  /**\n   * Check if a year is a leap year\n   * @param {number} year - Year to check\n   * @returns {boolean} - Whether the year is a leap year\n   */\n  static isLeapYear(year: number): boolean {\n    return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);\n  }\n\n  /**\n   * Enhanced manual parsing with better error handling\n   * @param {string} dateString - Date string to parse\n   * @returns {number} - Unix timestamp\n   */\n  static parseISODateManual(dateString: string): number {\n    if (typeof dateString === 'string' && dateString.includes('T')) {\n      // Check if the string contains timezone information (Z, +XX:XX, -XX:XX)\n      const hasTimezone = /[+-]\\d{2}:\\d{2}$|Z$/.test(dateString);\n      \n      if (hasTimezone) {\n        // For ISO strings with timezone info, use native Date parsing to preserve timezone\n        return new Date(dateString).getTime();\n      } else {\n        // For timezone-less ISO strings, use manual parsing for cross-platform consistency\n        const [datePart, timePart] = dateString.split('T');\n        const [year, month, day] = datePart.split('-').map(Number);\n        \n        // Validate date components\n        if (!this.isValidDateComponents(year, month, day)) {\n          throw new Error('Invalid date components');\n        }\n        \n        if (timePart && timePart.includes(':')) {\n          const [hour, minute, second] = timePart.split(':').map(parseFloat);\n          \n          // Validate time components\n          if (!this.isValidTimeComponents(hour, minute, second)) {\n            throw new Error('Invalid time components');\n          }\n          \n          return new Date(year, month - 1, day, hour, minute, second || 0).getTime();\n        } else {\n          return new Date(year, month - 1, day).getTime();\n        }\n      }\n    } else {\n      // Fallback to regular parsing for other formats\n      return new Date(dateString).getTime();\n    }\n  }\n\n  /**\n   * Validates date components\n   * @param {number} year - Year component\n   * @param {number} month - Month component (1-12)\n   * @param {number} day - Day component\n   * @returns {boolean} - Whether components are valid\n   */\n  static isValidDateComponents(year: number, month: number, day: number): boolean {\n    if (isNaN(year) || isNaN(month) || isNaN(day)) return false;\n    if (year < 1970 || year > 2100) return false;\n    if (month < 1 || month > 12) return false;\n    if (day < 1 || day > 31) return false;\n    \n    // Check days in month\n    const daysInMonth = [31, this.isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n    if (day > daysInMonth[month - 1]) return false;\n    \n    return true;\n  }\n\n  /**\n   * Validates time components\n   * @param {number} hour - Hour component\n   * @param {number} minute - Minute component\n   * @param {number} second - Second component\n   * @returns {boolean} - Whether components are valid\n   */\n  static isValidTimeComponents(hour: any, minute: any, second: any): boolean {\n    const h = parseInt(hour);\n    const m = parseInt(minute);\n    const s = parseInt(second);\n    \n    if (isNaN(h) || isNaN(m) || isNaN(s)) return false;\n    if (h < 0 || h > 23) return false;\n    if (m < 0 || m > 59) return false;\n    if (s < 0 || s > 59) return false;\n    \n    return true;\n  }\n\n  /**\n   * Final fallback parsing method\n   * @param {string} dateString - Date string to parse\n   * @returns {number} - Unix timestamp\n   */\n  static parseISODateFallback(dateString: string): number {\n    try {\n      const timestamp = Date.parse(dateString);\n      if (!isNaN(timestamp)) {\n        return timestamp;\n      }\n      \n      // Last resort: return current time as fallback\n      return Date.now();\n    } catch (error) {\n      return Date.now();\n    }\n  }\n}","/**\n * ConfigValidator - Comprehensive input validation for TimeFlow Card configuration\n * Ensures security, type safety, and data integrity with graceful error handling\n */\n\nexport interface ValidationError {\n  field: string;\n  message: string;\n  severity: 'critical' | 'warning' | 'info';\n  suggestion?: string;\n  value?: any;\n}\n\nexport interface ValidationResult {\n  isValid: boolean;\n  errors: ValidationError[];\n  hasCriticalErrors: boolean;\n  hasWarnings: boolean;\n  safeConfig?: any;\n}\n\nexport class ConfigValidator {\n  /**\n   * Comprehensive input validation for configuration with severity levels\n   * @param {Object} config - Configuration object to validate\n   * @returns {ValidationResult} - Detailed validation result\n   */\n  static validateConfig(config: any): ValidationResult {\n    const errors: ValidationError[] = [];\n    \n    // Check if config is null or undefined\n    if (!config) {\n      errors.push({\n        field: 'config',\n        message: 'Configuration object is missing or empty',\n        severity: 'critical',\n        suggestion: 'Provide a valid configuration object with at least a target_date field.',\n        value: config\n      });\n      return {\n        isValid: false,\n        errors,\n        hasCriticalErrors: true,\n        hasWarnings: false\n      };\n    }\n    \n    // Validate target_date (required field, unless using timer_entity or auto_discover_alexa)\n    if (config.target_date) {\n      if (!this.isValidDateInput(config.target_date)) {\n        errors.push({\n          field: 'target_date',\n          message: 'Invalid target_date format',\n          severity: 'critical',\n          suggestion: 'Use ISO date string (2025-12-31T23:59:59), entity ID (sensor.my_date), or template ({{ states(\"sensor.date\") }}).',\n          value: config.target_date\n        });\n      }\n    } else if (!config.timer_entity && !config.auto_discover_alexa) {\n      // target_date is only required if timer_entity and auto_discover_alexa are not provided\n      errors.push({\n        field: 'target_date',\n        message: 'Either \"target_date\", \"timer_entity\", or \"auto_discover_alexa\" must be provided',\n        severity: 'critical',\n        suggestion: 'Add target_date field with a valid date value like \"2025-12-31T23:59:59\" OR specify a timer_entity like \"timer.my_timer\" OR enable auto_discover_alexa.',\n        value: undefined\n      });\n    }\n    \n    // Validate timer_entity if provided\n    if (config.timer_entity && !this.isValidEntityId(config.timer_entity)) {\n      errors.push({\n        field: 'timer_entity',\n        message: 'Invalid timer_entity format',\n        severity: 'warning',\n        suggestion: 'Use a valid entity ID like \"timer.my_timer\" or \"sensor.alexa_timer\".',\n        value: config.timer_entity\n      });\n    }\n    \n    // Validate creation_date if provided (optional field)\n    if (config.creation_date && !this.isValidDateInput(config.creation_date)) {\n      errors.push({\n        field: 'creation_date',\n        message: 'Invalid creation_date format',\n        severity: 'warning',\n        suggestion: 'Use ISO date string, entity ID, or template. This field is optional.',\n        value: config.creation_date\n      });\n    }\n    \n    // Validate colors\n    const colorFields = ['color', 'background_color', 'progress_color'];\n    colorFields.forEach(field => {\n      if (config[field] && !this.isValidColorInput(config[field])) {\n        errors.push({\n          field,\n          message: `Invalid ${field} format`,\n          severity: 'warning',\n          suggestion: 'Use hex (#ff0000), rgb/rgba, hsl/hsla, CSS color name, entity ID, or template.',\n          value: config[field]\n        });\n      }\n    });\n    \n    // Validate dimensions\n    const dimensionFields = ['width', 'height', 'icon_size'];\n    dimensionFields.forEach(field => {\n      if (config[field] && !this.isValidDimensionInput(config[field])) {\n        errors.push({\n          field,\n          message: `Invalid ${field} format`,\n          severity: 'warning',\n          suggestion: 'Use pixel values (100px), percentages (50%), or CSS units (2rem).',\n          value: config[field]\n        });\n      }\n    });\n    \n    // Validate aspect_ratio\n    if (config.aspect_ratio && !this.isValidAspectRatioInput(config.aspect_ratio)) {\n      errors.push({\n        field: 'aspect_ratio',\n        message: 'Invalid aspect_ratio format',\n        severity: 'warning',\n        suggestion: 'Use format like \"16/9\", \"4/3\", or \"1/1\".',\n        value: config.aspect_ratio\n      });\n    }\n    \n    // Validate stroke_width\n    if (config.stroke_width !== undefined && !this.isValidNumberInput(config.stroke_width, 1, 50)) {\n      errors.push({\n        field: 'stroke_width',\n        message: 'Invalid stroke_width value',\n        severity: 'warning',\n        suggestion: 'Must be a number between 1 and 50.',\n        value: config.stroke_width\n      });\n    }\n    \n    // Validate boolean fields\n    const booleanFields = ['show_months', 'show_days', 'show_hours', 'show_minutes', 'show_seconds', 'expired_animation', 'show_progress_text'];\n    booleanFields.forEach(field => {\n      if (config[field] !== undefined && !this.isValidBooleanInput(config[field])) {\n        errors.push({\n          field,\n          message: `Invalid ${field} value`,\n          severity: 'warning',\n          suggestion: 'Must be true or false (boolean value).',\n          value: config[field]\n        });\n      }\n    });\n    \n    // Validate text fields for XSS prevention\n    const textFields = ['title', 'subtitle', 'expired_text'];\n    textFields.forEach(field => {\n      if (config[field] && !this.isValidTextInput(config[field])) {\n        errors.push({\n          field,\n          message: `Invalid ${field} - contains potentially unsafe content`,\n          severity: 'critical',\n          suggestion: 'Remove script tags, javascript: URLs, and event handlers for security.',\n          value: config[field]\n        });\n      }\n    });\n    \n    // Validate styles object\n    if (config.styles && !this.isValidStylesInput(config.styles)) {\n      errors.push({\n        field: 'styles',\n        message: 'Invalid styles object structure',\n        severity: 'warning',\n        suggestion: 'Must contain valid style arrays for card, title, subtitle, or progress_circle.',\n        value: config.styles\n      });\n    }\n\n    // Additional helpful validations\n    this._addHelpfulValidations(config, errors);\n\n    // Generate safe config for graceful degradation\n    const safeConfig = this._generateSafeConfig(config, errors);\n\n    const criticalErrors = errors.filter(e => e.severity === 'critical');\n    const warnings = errors.filter(e => e.severity === 'warning');\n\n    return {\n      isValid: criticalErrors.length === 0 && warnings.length === 0,\n      errors,\n      hasCriticalErrors: criticalErrors.length > 0,\n      hasWarnings: warnings.length > 0,\n      safeConfig\n    };\n  }\n\n  /**\n   * Add additional helpful validations and suggestions\n   */\n  private static _addHelpfulValidations(config: any, errors: ValidationError[]): void {\n    // No additional validations needed - only validate fields that exist in config\n    // Remove unknown field warnings as requested\n  }\n\n  /**\n   * Generate a safe configuration with fallback values\n   */\n  private static _generateSafeConfig(config: any, errors: ValidationError[]): any {\n    const safeConfig = { ...config };\n    \n    // Apply safe defaults for fields with errors\n    errors.forEach(error => {\n      if (error.severity === 'critical' || error.severity === 'warning') {\n        switch (error.field) {\n          case 'target_date':\n            if (!safeConfig.target_date && !safeConfig.timer_entity) {\n              // Only set a default target_date if no timer_entity is provided\n              const tomorrow = new Date();\n              tomorrow.setDate(tomorrow.getDate() + 1);\n              safeConfig.target_date = tomorrow.toISOString();\n            }\n            break;\n          case 'background_color':\n            if (!this.isValidColorInput(safeConfig.background_color)) {\n              safeConfig.background_color = '#1a1a1a';\n            }\n            break;\n          case 'progress_color':\n            if (!this.isValidColorInput(safeConfig.progress_color)) {\n              safeConfig.progress_color = '#4caf50';\n            }\n            break;\n          case 'stroke_width':\n            if (!this.isValidNumberInput(safeConfig.stroke_width, 1, 50)) {\n              safeConfig.stroke_width = 15;\n            }\n            break;\n          case 'icon_size':\n            if (!this.isValidDimensionInput(safeConfig.icon_size)) {\n              safeConfig.icon_size = 100;\n            }\n            break;\n        }\n      }\n    });\n\n    return safeConfig;\n  }\n\n  /**\n   * Legacy method for backward compatibility - now throws ValidationError\n   * @deprecated Use validateConfig() instead which returns ValidationResult\n   */\n  static validateConfigLegacy(config: any): void {\n    const result = this.validateConfig(config);\n    if (result.hasCriticalErrors) {\n      const criticalErrors = result.errors.filter(e => e.severity === 'critical');\n      throw new Error(`Configuration validation failed:\\n ${criticalErrors.map(e => e.message).join('\\n ')}`);\n    }\n  }\n  \n  /**\n   * Validates date input (string, entity, or template)\n   * @param {*} value - Value to validate\n   * @returns {boolean} - Whether the value is valid\n   */\n  static isValidDateInput(value: any): boolean {\n    if (!value) return false;\n    \n    // Allow templates\n    if (this.isTemplate(value)) return true;\n    \n    // Allow entity IDs\n    if (typeof value === 'string' && value.includes('.')) return true;\n    \n    // Validate date string format\n    if (typeof value === 'string') {\n      try {\n        const date = new Date(value);\n        return !isNaN(date.getTime());\n      } catch (e) {\n        return false;\n      }\n    }\n    \n    return false;\n  }\n  \n  /**\n   * Validates color input (color value, entity, or template)\n   * @param {*} value - Value to validate\n   * @returns {boolean} - Whether the value is valid\n   */\n  static isValidColorInput(value: any): boolean {\n    if (!value) return false;\n    \n    // Allow templates and entities\n    if (this.isTemplate(value) || (typeof value === 'string' && value.includes('.'))) return true;\n    \n    if (typeof value !== 'string') return false;\n    \n    // Check hex colors\n    if (/^#([0-9A-F]{3}){1,2}$/i.test(value)) return true;\n    \n    // Check rgb/rgba\n    if (/^rgba?\\(\\s*\\d+\\s*,\\s*\\d+\\s*,\\s*\\d+\\s*(,\\s*[\\d.]+\\s*)?\\)$/i.test(value)) return true;\n    \n    // Check hsl/hsla\n    if (/^hsla?\\(\\s*\\d+\\s*,\\s*\\d+%\\s*,\\s*\\d+%\\s*(,\\s*[\\d.]+\\s*)?\\)$/i.test(value)) return true;\n    \n    // Check CSS color names (expanded list)\n    const cssColors = [\n      'red', 'blue', 'green', 'yellow', 'orange', 'purple', 'pink', 'brown', 'black', 'white', 'gray', 'grey',\n      'cyan', 'magenta', 'lime', 'maroon', 'navy', 'olive', 'teal', 'silver', 'gold', 'indigo', 'violet',\n      'transparent', 'currentColor', 'inherit', 'initial', 'unset'\n    ];\n    \n    return cssColors.includes(value.toLowerCase());\n  }\n  \n  /**\n   * Validates dimension input (dimension value, entity, or template)\n   * @param {*} value - Value to validate\n   * @returns {boolean} - Whether the value is valid\n   */\n  static isValidDimensionInput(value: any): boolean {\n    if (!value) return false;\n    \n    // Allow templates and entities\n    if (this.isTemplate(value) || (typeof value === 'string' && value.includes('.'))) return true;\n    \n    // Allow numbers\n    if (typeof value === 'number') return true;\n    \n    if (typeof value !== 'string') return false;\n    \n    // Check pixel values (0-10000px)\n    const pxMatch = value.match(/^(\\d+(?:\\.\\d+)?)px$/i);\n    if (pxMatch) {\n      const px = parseFloat(pxMatch[1]);\n      return px >= 0 && px <= 10000;\n    }\n    \n    // Check percentage values (0-1000%)\n    const percentMatch = value.match(/^(\\d+(?:\\.\\d+)?)%$/i);\n    if (percentMatch) {\n      const percent = parseFloat(percentMatch[1]);\n      return percent >= 0 && percent <= 1000;\n    }\n    \n    // Check other valid CSS units\n    const validUnits = ['em', 'rem', 'vh', 'vw', 'vmin', 'vmax', 'ch', 'ex'];\n    for (const unit of validUnits) {\n      const regex = new RegExp(`^(\\\\d+(?:\\\\.\\\\d+)?)${unit}$`, 'i');\n      const match = value.match(regex);\n      if (match) {\n        const unitValue = parseFloat(match[1]);\n        return unitValue >= 0 && unitValue <= 1000; // Reasonable bounds\n      }\n    }\n    \n    // Check for 'auto', 'fit-content', etc.\n    const validKeywords = ['auto', 'fit-content', 'min-content', 'max-content'];\n    return validKeywords.includes(value.toLowerCase());\n  }\n  \n  /**\n   * Validates aspect ratio input\n   * @param {*} value - Value to validate\n   * @returns {boolean} - Whether the value is valid\n   */\n  static isValidAspectRatioInput(value: any): boolean {\n    if (!value) return false;\n    \n    // Allow templates and entities\n    if (this.isTemplate(value) || (typeof value === 'string' && value.includes('.'))) return true;\n    \n    if (typeof value !== 'string') return false;\n    \n    // Check aspect ratio format: number/number\n    const aspectMatch = value.match(/^(\\d+(?:\\.\\d+)?)\\/(\\d+(?:\\.\\d+)?)$/);\n    if (aspectMatch) {\n      const width = parseFloat(aspectMatch[1]);\n      const height = parseFloat(aspectMatch[2]);\n      return width > 0 && height > 0 && width <= 20 && height <= 20; // Reasonable bounds\n    }\n    \n    return false;\n  }\n  \n  /**\n   * Validates number input with optional bounds\n   * @param {*} value - Value to validate\n   * @param {number} min - Minimum allowed value\n   * @param {number} max - Maximum allowed value\n   * @returns {boolean} - Whether the value is valid\n   */\n  static isValidNumberInput(value: any, min: number = -Infinity, max: number = Infinity): boolean {\n    if (value === undefined || value === null) return false;\n    \n    // Allow templates and entities\n    if (typeof value === 'string') {\n      if (this.isTemplate(value) || value.includes('.')) return true;\n      // Try to parse string numbers\n      const parsed = parseFloat(value);\n      return !isNaN(parsed) && parsed >= min && parsed <= max;\n    }\n    \n    return typeof value === 'number' && !isNaN(value) && value >= min && value <= max;\n  }\n  \n  /**\n   * Validates boolean input\n   * @param {*} value - Value to validate\n   * @returns {boolean} - Whether the value is valid\n   */\n  static isValidBooleanInput(value: any): boolean {\n    return typeof value === 'boolean';\n  }\n  \n  /**\n   * Validates text input for XSS prevention\n   * @param {*} value - Value to validate\n   * @returns {boolean} - Whether the value is valid\n   */\n  static isValidTextInput(value: any): boolean {\n    if (!value) return true;\n    \n    // Allow templates and entities\n    if (this.isTemplate(value) || (typeof value === 'string' && value.includes('.'))) return true;\n    \n    if (typeof value !== 'string') return false;\n    \n    // Check for potentially dangerous content\n    const dangerousPatterns = [\n      /<script/i,\n      /javascript:/i,\n      /vbscript:/i,\n      /on\\w+\\s*=/i, // Event handlers like onclick=\n      /<iframe/i,\n      /<object/i,\n      /<embed/i,\n      /<form/i\n    ];\n    \n    return !dangerousPatterns.some(pattern => pattern.test(value));\n  }\n  \n  /**\n   * Validates styles object structure\n   * @param {*} styles - Styles object to validate\n   * @returns {boolean} - Whether the styles are valid\n   */\n  static isValidStylesInput(styles: any): boolean {\n    if (!styles || typeof styles !== 'object') return false;\n    \n    const validStyleKeys = ['card', 'title', 'subtitle', 'progress_circle'];\n    \n    // Check that all keys are valid\n    const styleKeys = Object.keys(styles);\n    if (!styleKeys.every(key => validStyleKeys.includes(key))) return false;\n    \n    // Check that all values are arrays\n    return styleKeys.every(key => Array.isArray(styles[key]));\n  }\n\n  /**\n   * Detects if a value contains Home Assistant templates\n   * @param {*} value - Value to check\n   * @returns {boolean} - Whether the value is a template\n   */\n  static isTemplate(value: any): boolean {\n    return typeof value === 'string' && \n           value.includes('{{') && \n           value.includes('}}');\n  }\n\n  /**\n   * Validates entity ID format\n   * @param {*} value - Value to validate\n   * @returns {boolean} - Whether the value is a valid entity ID\n   */\n  static isValidEntityId(value: any): boolean {\n    if (!value || typeof value !== 'string') return false;\n    \n    // Allow templates\n    if (this.isTemplate(value)) return true;\n    \n    // Basic entity ID format: domain.entity_name\n    const entityPattern = /^[a-z_]+\\.[a-z0-9_]+$/;\n    return entityPattern.test(value);\n  }\n}\n","import { HomeAssistant, TimeFlowCard } from '../types/index';\n\ninterface CacheEntry {\n  result: any;\n  timestamp: number;\n}\n\n/**\n * TemplateService - Handles Home Assistant template evaluation and caching\n * Provides efficient template processing with intelligent caching\n */\nexport class TemplateService {\n  private templateResults: Map<string, CacheEntry>;\n  private templateCacheLimit: number;\n  public card?: TimeFlowCard;\n\n  constructor() {\n    this.templateResults = new Map();\n    this.templateCacheLimit = 100;\n  }\n\n  /**\n   * Evaluates a Home Assistant template using the correct API\n   * @param {string} template - Template string to evaluate\n   * @param {Object} hass - Home Assistant object\n   * @returns {Promise<*>} - Evaluated template result\n   */\n  async evaluateTemplate(template: string, hass: HomeAssistant | null): Promise<any> {\n    if (!hass || !template) {\n      return template;\n    }\n\n    // Check cache first\n    const cacheKey = template;\n    if (this.templateResults.has(cacheKey)) {\n      const cached = this.templateResults.get(cacheKey);\n      // Use much longer cache for date templates to prevent oscillation near expiration\n      const cacheTimeout = this.isDateTemplate(template) ? 60000 : 5000; // 60s for dates, 5s for others\n      if (cached && Date.now() - cached.timestamp < cacheTimeout) {\n        return cached.result;\n      }\n    }\n\n    try {\n      // Validate template format before making API call\n      if (!this.isValidTemplate(template)) {\n        throw new Error('Invalid template format');\n      }\n\n      // Use callApi method like card-tools and button-card for HA templates\n      const result = await hass.callApi('POST', 'template', { \n        template: template \n      });\n      \n      // Check if the template evaluation succeeded but returned 'unknown'\n      if (result === 'unknown' || result === 'unavailable' || result === '' || result === null) {\n        // Try to extract fallback from the template itself\n        const fallback = this.extractFallbackFromTemplate(template);\n        if (fallback && fallback !== template) {\n          // Cache the fallback result\n          this.templateResults.set(cacheKey, {\n            result: fallback,\n            timestamp: Date.now()\n          });\n          \n          // Enforce cache size limits\n          this.enforceTemplateCacheLimit();\n          \n          return fallback;\n        }\n      }\n      \n      // Cache the result\n      this.templateResults.set(cacheKey, {\n        result: result,\n        timestamp: Date.now()\n      });\n      \n      // Enforce cache size limits\n      this.enforceTemplateCacheLimit();\n      \n      return result;\n    } catch (error: any) {\n      // Template evaluation failed, use fallback\n      const fallback = this.extractFallbackFromTemplate(template);\n      \n      // Cache the fallback to prevent repeated failed calls\n      this.templateResults.set(cacheKey, {\n        result: fallback,\n        timestamp: Date.now()\n      });\n      \n      this.enforceTemplateCacheLimit();\n      return fallback;\n    }\n  }\n\n  /**\n   * Extracts fallback value from template expressions with 'or' operator\n   * @param {string} template - Template string\n   * @returns {string} - Extracted fallback value\n   */\n  extractFallbackFromTemplate(template: string): string {\n    if (!template || typeof template !== 'string') {\n      return template;\n    }\n\n    try {\n      // Remove the outer {{ }} to work with the inner expression\n      const innerTemplate = template.replace(/^\\{\\{\\s*/, '').replace(/\\s*\\}\\}$/, '').trim();\n      \n      // Look for patterns like \"states('entity') or 'fallback'\"\n      const simpleOrPattern = /^(.+?)\\s+or\\s+['\"`]([^'\"`]+)['\"`]$/;\n      const simpleOrMatch = innerTemplate.match(simpleOrPattern);\n      \n      if (simpleOrMatch && simpleOrMatch[2]) {\n        return simpleOrMatch[2];\n      }\n\n      // Look for chained or patterns like \"states('entity1') or states('entity2') or 'fallback'\"\n      const chainedOrPattern = /^(.+?)\\s+or\\s+(.+?)\\s+or\\s+['\"`]([^'\"`]+)['\"`]$/;\n      const chainedMatch = innerTemplate.match(chainedOrPattern);\n      \n      if (chainedMatch && chainedMatch[3]) {\n        return chainedMatch[3];\n      }\n\n      // Look for conditional patterns like \"'value' if condition else 'fallback'\"\n      const conditionalPattern = /^['\"`]([^'\"`]+)['\"`]\\s+if\\s+(.+?)\\s+else\\s+['\"`]([^'\"`]+)['\"`]$/;\n      const conditionalMatch = innerTemplate.match(conditionalPattern);\n      \n      if (conditionalMatch && conditionalMatch[3]) {\n        return conditionalMatch[3];\n      }\n\n      // Look for reverse conditional patterns like \"condition if test else 'fallback'\"\n      const reverseConditionalPattern = /^(.+?)\\s+if\\s+(.+?)\\s+else\\s+['\"`]([^'\"`]+)['\"`]$/;\n      const reverseMatch = innerTemplate.match(reverseConditionalPattern);\n      \n      if (reverseMatch && reverseMatch[3]) {\n        return reverseMatch[3];\n      }\n\n      // If no fallback pattern found, return a helpful message\n      return 'Unavailable';\n    } catch (error) {\n      return 'Template Error';\n    }\n  }\n\n  /**\n   * Detects if a template is likely calculating dates/times\n   * @param {string} template - Template to check\n   * @returns {boolean} - Whether template appears to be date-related\n   */\n  isDateTemplate(template: string): boolean {\n    if (!template || typeof template !== 'string') return false;\n    \n    // Look for common date/time functions and keywords\n    const dateKeywords = [\n      'as_datetime', 'timedelta', 'isoformat', 'strftime',\n      'now()', 'today', 'utcnow', 'timestamp',\n      'days=', 'hours=', 'minutes=', 'seconds='\n    ];\n    \n    return dateKeywords.some(keyword => template.includes(keyword));\n  }\n\n  /**\n   * Detects if a value contains Home Assistant templates\n   * @param {*} value - Value to check\n   * @returns {boolean} - Whether the value is a template\n   */\n  isTemplate(value: any): boolean {\n    return typeof value === 'string' && \n           value.includes('{{') && \n           value.includes('}}');\n  }\n\n  /**\n   * Validates template format to prevent bad API calls\n   * @param {string} template - Template string to validate\n   * @returns {boolean} - Whether template is valid\n   */\n  isValidTemplate(template: string): boolean {\n    if (!template || typeof template !== 'string') return false;\n    \n    // Check for basic template format\n    if (!template.includes('{{') || !template.includes('}}')) return false;\n    \n    // Check for balanced braces\n    const openBraces = (template.match(/\\{\\{/g) || []).length;\n    const closeBraces = (template.match(/\\}\\}/g) || []).length;\n    if (openBraces !== closeBraces) return false;\n    \n    // Check for empty template\n    const content = template.replace(/\\{\\{\\s*/, '').replace(/\\s*\\}\\}/, '').trim();\n    if (!content) return false;\n    \n    return true;\n  }\n\n  /**\n   * Enhanced value resolver that handles entities, templates, and plain strings\n   * @param {*} value - Value to resolve\n   * @returns {Promise<*>} - Resolved value\n   */\n  async resolveValue(value: string): Promise<string | undefined> {\n    if (!value) return undefined;\n\n    if (this.isTemplate(value)) {\n      const hass = this.card?.hass || null;\n      const result = await this.evaluateTemplate(value, hass);\n      return result || undefined;\n    }\n\n    // Handle entity state\n    const hass = this.card?.hass;\n    if (typeof value === 'string' && value.includes('.') && hass && hass.states[value]) {\n      const entity = hass.states[value];\n      if (!entity) {\n        return undefined;\n      }\n      return entity.state;\n    }\n\n    return value;\n  }\n\n  /**\n   * Clears template cache when entities change\n   */\n  clearTemplateCache() {\n    this.templateResults.clear();\n  }\n\n  /**\n   * Enforces template cache size limits to prevent memory growth\n   */\n  enforceTemplateCacheLimit() {\n    if (this.templateResults.size <= this.templateCacheLimit) {\n      return;\n    }\n\n    // Convert to array and sort by timestamp (oldest first)\n    const cacheEntries = Array.from(this.templateResults.entries())\n      .sort((a, b) => a[1].timestamp - b[1].timestamp);\n\n    // Remove oldest entries until we're under the limit\n    const entriesToRemove = cacheEntries.length - this.templateCacheLimit;\n    for (let i = 0; i < entriesToRemove; i++) {\n      this.templateResults.delete(cacheEntries[i][0]);\n    }\n  }\n\n  /**\n   * Checks if the current config contains any templates\n   * @param {Object} config - Configuration object\n   * @returns {boolean} - Whether config contains templates\n   */\n  hasTemplatesInConfig(config: any): boolean {\n    if (!config) return false;\n    \n    // Check common template-enabled properties\n    const templateProperties = [\n      'target_date', 'creation_date', 'title', 'subtitle',\n      'color', 'background_color', 'progress_color', 'primary_color', 'secondary_color'\n    ];\n    \n    return templateProperties.some(prop => \n      config[prop] && this.isTemplate(config[prop])\n    );\n  }\n\n  /**\n   * Escapes HTML special characters to prevent XSS and ensure proper display\n   * @param {*} text - Text to escape\n   * @returns {string} - Escaped text\n   */\n  escapeHtml(text: string): string {\n    if (text == null || text === undefined) return '';\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n}","import { TemplateService } from './TemplateService';\nimport { HomeAssistant, CountdownState, CardConfig } from '../types/index';\nimport { TimerEntityService } from './Timer';\n\n/**\n * CountdownService - Enhanced with Alexa Timer support\n * Handles countdown calculations and time unit management\n * Provides clean separation of countdown logic from presentation\n */\nexport class CountdownService {\n  private templateService: any;\n  private dateParser: any;\n  private timeRemaining: CountdownState;\n  private expired: boolean;\n\n  constructor(templateService: any, dateParser: any) {\n    this.templateService = templateService;\n    this.dateParser = dateParser;\n    this.timeRemaining = { months: 0, days: 0, hours: 0, minutes: 0, seconds: 0, total: 0 };\n    this.expired = false;\n  }\n\n  /**\n   * Updates the countdown based on current configuration (enhanced for Alexa)\n   * @param {Object} config - Card configuration\n   * @param {Object} hass - Home Assistant object\n   * @returns {Promise<Object>} - Time remaining object\n   */\n  async updateCountdown(config: CardConfig, hass: HomeAssistant | null): Promise<CountdownState> {\n    try {\n      // TIMER ENTITY SUPPORT (including Alexa timers)\n      if (config.timer_entity && hass) {\n        const timerData = TimerEntityService.getTimerData(config.timer_entity, hass);\n        if (timerData) {\n          // Convert TimerData to CountdownState\n          this.timeRemaining = this._timerDataToCountdownState(timerData);\n          this.expired = TimerEntityService.isTimerExpired(timerData);\n          return this.timeRemaining;\n        }\n      }\n      \n      // AUTO-DISCOVERY: If no timer_entity specified, try to find Alexa timers\n      if (!config.timer_entity && config.auto_discover_alexa && hass) {\n        const alexaTimers = TimerEntityService.discoverAlexaTimers(hass);\n        if (alexaTimers.length > 0) {\n          // Use the first active Alexa timer found\n          const firstActiveTimer = alexaTimers.find(entityId => {\n            const timerData = TimerEntityService.getTimerData(entityId, hass);\n            return timerData && timerData.isActive;\n          });\n          \n          if (firstActiveTimer) {\n            const timerData = TimerEntityService.getTimerData(firstActiveTimer, hass);\n            if (timerData) {\n              this.timeRemaining = this._timerDataToCountdownState(timerData);\n              this.expired = TimerEntityService.isTimerExpired(timerData);\n              return this.timeRemaining;\n            }\n          }\n        }\n      }\n      \n      if (!config.target_date) return this.timeRemaining;\n      \n      const now = new Date().getTime();\n      const targetDateValue = await this.templateService.resolveValue(config.target_date);\n      \n      if (!targetDateValue) {\n        return this.timeRemaining;\n      }\n      \n      // Use the helper method for consistent date parsing\n      const targetDate = this.dateParser.parseISODate(targetDateValue);\n      \n      if (isNaN(targetDate)) {\n        return this.timeRemaining;\n      }\n      \n      const difference = targetDate - now;\n\n      if (difference > 0) {\n        // Calculate time units based on what's enabled - cascade disabled units into enabled ones\n        const { show_months, show_days, show_hours, show_minutes, show_seconds } = config;\n        \n        let totalMilliseconds = difference;\n        let months = 0, days = 0, hours = 0, minutes = 0, seconds = 0;\n        \n        // Find the largest enabled unit and calculate everything from there\n        if (show_months) {\n          months = Math.floor(totalMilliseconds / (1000 * 60 * 60 * 24 * 30.44)); // Average month length\n          totalMilliseconds %= (1000 * 60 * 60 * 24 * 30.44);\n        }\n        \n        if (show_days) {\n          days = Math.floor(totalMilliseconds / (1000 * 60 * 60 * 24));\n          totalMilliseconds %= (1000 * 60 * 60 * 24);\n        } else if (show_months && !show_days) {\n          // If days are disabled but months are enabled, add days to months\n          const extraDays = Math.floor(totalMilliseconds / (1000 * 60 * 60 * 24));\n          months += Math.floor(extraDays / 30.44);\n          totalMilliseconds %= (1000 * 60 * 60 * 24);\n        }\n        \n        if (show_hours) {\n          hours = Math.floor(totalMilliseconds / (1000 * 60 * 60));\n          totalMilliseconds %= (1000 * 60 * 60);\n        } else if ((show_months || show_days) && !show_hours) {\n          // If hours are disabled but larger units are enabled, add hours to the largest enabled unit\n          const extraHours = Math.floor(totalMilliseconds / (1000 * 60 * 60));\n          if (show_days) {\n            days += Math.floor(extraHours / 24);\n          } else if (show_months) {\n            months += Math.floor(extraHours / (24 * 30.44));\n          }\n          totalMilliseconds %= (1000 * 60 * 60);\n        }\n        \n        if (show_minutes) {\n          minutes = Math.floor(totalMilliseconds / (1000 * 60));\n          totalMilliseconds %= (1000 * 60);\n        } else if ((show_months || show_days || show_hours) && !show_minutes) {\n          // If minutes are disabled but larger units are enabled, add minutes to the largest enabled unit\n          const extraMinutes = Math.floor(totalMilliseconds / (1000 * 60));\n          if (show_hours) {\n            hours += Math.floor(extraMinutes / 60);\n          } else if (show_days) {\n            days += Math.floor(extraMinutes / (60 * 24));\n          } else if (show_months) {\n            months += Math.floor(extraMinutes / (60 * 24 * 30.44));\n          }\n          totalMilliseconds %= (1000 * 60);\n        }\n        \n        if (show_seconds) {\n          seconds = Math.floor(totalMilliseconds / 1000);\n        } else if ((show_months || show_days || show_hours || show_minutes) && !show_seconds) {\n          // If seconds are disabled but larger units are enabled, add seconds to the largest enabled unit\n          const extraSeconds = Math.floor(totalMilliseconds / 1000);\n          if (show_minutes) {\n            minutes += Math.floor(extraSeconds / 60);\n          } else if (show_hours) {\n            hours += Math.floor(extraSeconds / (60 * 60));\n          } else if (show_days) {\n            days += Math.floor(extraSeconds / (60 * 60 * 24));\n          } else if (show_months) {\n            months += Math.floor(extraSeconds / (60 * 60 * 24 * 30.44));\n          }\n        }\n\n        this.timeRemaining = { months, days, hours, minutes, seconds, total: difference };\n        this.expired = false;\n      } else {\n        // Countdown has reached zero or passed - mark as expired\n        this.timeRemaining = { months: 0, days: 0, hours: 0, minutes: 0, seconds: 0, total: 0 };\n        this.expired = true;\n      }\n      \n      return this.timeRemaining;\n    } catch (error) {\n      return this.timeRemaining;\n    }\n  }\n\n  /**\n   * Calculates progress percentage (enhanced for Alexa)\n   * @param {Object} config - Card configuration\n   * @param {Object} hass - Home Assistant object\n   * @returns {Promise<number>} - Progress percentage (0-100)\n   */\n  async calculateProgress(config: CardConfig, hass: HomeAssistant | null): Promise<number> {\n    // TIMER ENTITY SUPPORT (including Alexa timers)\n    if (config.timer_entity && hass) {\n      const timerData = TimerEntityService.getTimerData(config.timer_entity, hass);\n      if (!timerData) return 0;\n      return timerData.progress;\n    }\n    \n    // AUTO-DISCOVERY: Try Alexa timers if enabled\n    if (!config.timer_entity && config.auto_discover_alexa && hass) {\n      const alexaTimers = TimerEntityService.discoverAlexaTimers(hass);\n      if (alexaTimers.length > 0) {\n        const firstActiveTimer = alexaTimers.find(entityId => {\n          const timerData = TimerEntityService.getTimerData(entityId, hass);\n          return timerData && timerData.isActive;\n        });\n        \n        if (firstActiveTimer) {\n          const timerData = TimerEntityService.getTimerData(firstActiveTimer, hass);\n          if (timerData) return timerData.progress;\n        }\n      }\n    }\n    \n    const targetDateValue = await this.templateService.resolveValue(config.target_date);\n    if (!targetDateValue) return 0;\n    \n    // Use the helper method for consistent date parsing\n    const targetDate = this.dateParser.parseISODate(targetDateValue);\n    const now = Date.now();\n    \n    let creationDate;\n    if (config.creation_date) {\n      const creationDateValue = await this.templateService.resolveValue(config.creation_date);\n      \n      if (creationDateValue) {\n        // Use the helper method for consistent date parsing\n        creationDate = this.dateParser.parseISODate(creationDateValue);\n      } else {\n        creationDate = now;\n      }\n    } else {\n      creationDate = now; // Fallback to now if somehow no creation date\n    }\n    \n    const totalDuration = targetDate - creationDate;\n    if (totalDuration <= 0) return 100;\n    \n    const elapsed = now - creationDate;\n    const progress = Math.min(100, Math.max(0, (elapsed / totalDuration) * 100));\n    \n    return this.expired ? 100 : progress;\n  }\n\n  /**\n   * Gets the main display value and label (enhanced for Alexa)\n   * @param {Object} config - Card configuration\n   * @param {Object} hass - Home Assistant object (NEW parameter)\n   * @returns {Object} - Object with value and label properties\n   */\n  getMainDisplay(config: CardConfig, hass?: HomeAssistant | null): { value: string; label: string } {\n    // TIMER ENTITY SUPPORT (including Alexa timers)\n    if (config.timer_entity && hass) {\n      const timerData = TimerEntityService.getTimerData(config.timer_entity, hass);\n      if (timerData) {\n        const { hours, minutes, seconds } = this.timeRemaining;\n        \n        // Special handling for Alexa timers\n        if (timerData.isAlexaTimer) {\n          if (TimerEntityService.isTimerExpired(timerData)) {\n            return { value: '', label: 'Timer finished!' };\n          }\n          if (hours > 0) return { value: hours.toString(), label: hours === 1 ? 'hour left' : 'hours left' };\n          if (minutes > 0) return { value: minutes.toString(), label: minutes === 1 ? 'minute left' : 'minutes left' };\n          return { value: seconds.toString(), label: seconds === 1 ? 'second left' : 'seconds left' };\n        }\n        \n        // Standard timer handling\n        if (hours > 0) return { value: hours.toString(), label: hours === 1 ? 'hour' : 'hours' };\n        if (minutes > 0) return { value: minutes.toString(), label: minutes === 1 ? 'minute' : 'minutes' };\n        return { value: seconds.toString(), label: seconds === 1 ? 'second' : 'seconds' };\n      }\n    }\n    \n    // AUTO-DISCOVERY: Try Alexa timers if enabled\n    if (!config.timer_entity && config.auto_discover_alexa && hass) {\n      const alexaTimers = TimerEntityService.discoverAlexaTimers(hass);\n      if (alexaTimers.length > 0) {\n        const firstActiveTimer = alexaTimers.find(entityId => {\n          const timerData = TimerEntityService.getTimerData(entityId, hass);\n          return timerData && timerData.isActive;\n        });\n        \n        if (firstActiveTimer) {\n          const timerData = TimerEntityService.getTimerData(firstActiveTimer, hass);\n          if (timerData) {\n            const { hours, minutes, seconds } = this.timeRemaining;\n            if (TimerEntityService.isTimerExpired(timerData)) {\n              return { value: '', label: 'Alexa timer finished!' };\n            }\n            if (hours > 0) return { value: hours.toString(), label: hours === 1 ? 'hour left' : 'hours left' };\n            if (minutes > 0) return { value: minutes.toString(), label: minutes === 1 ? 'minute left' : 'minutes left' };\n            return { value: seconds.toString(), label: seconds === 1 ? 'second left' : 'seconds left' };\n          }\n        }\n      }\n    }\n    \n    const { show_months, show_days, show_hours, show_minutes, show_seconds } = config;\n    const { months, days, hours, minutes, seconds } = this.timeRemaining;\n    \n    if (this.expired) {\n      return { value: '', label: 'Completed!' };\n    }\n    \n    // Show the largest time unit that is enabled and has a value > 0\n    if (show_months && months > 0) {\n      return { value: months.toString(), label: months === 1 ? 'month left' : 'months left' };\n    } else if (show_days && days > 0) {\n      return { value: days.toString(), label: days === 1 ? 'day left' : 'days left' };\n    } else if (show_hours && hours > 0) {\n      return { value: hours.toString(), label: hours === 1 ? 'hour left' : 'hours left' };\n    } else if (show_minutes && minutes > 0) {\n      return { value: minutes.toString(), label: minutes === 1 ? 'minute left' : 'minutes left' };\n    } else if (show_seconds && seconds >= 0) {\n      return { value: seconds.toString(), label: seconds === 1 ? 'second left' : 'seconds left' };\n    }\n    \n    return { value: '0', label: 'seconds left' };\n  }\n\n  /**\n   * Gets the subtitle text showing time breakdown (enhanced for Alexa)\n   * @param {Object} config - Card configuration\n   * @param {Object} hass - Home Assistant object\n   * @returns {string} - Formatted subtitle text\n   */\n  getSubtitle(config: CardConfig, hass: HomeAssistant | null): string {\n    // TIMER ENTITY SUPPORT (including Alexa timers)\n    if (config.timer_entity && hass) {\n      const timerData = TimerEntityService.getTimerData(config.timer_entity, hass);\n      if (timerData) {\n        return TimerEntityService.getTimerSubtitle(timerData, config.show_seconds !== false);\n      }\n      return 'Timer not found';\n    }\n    \n    // AUTO-DISCOVERY: Try Alexa timers if enabled\n    if (!config.timer_entity && config.auto_discover_alexa && hass) {\n      const alexaTimers = TimerEntityService.discoverAlexaTimers(hass);\n      if (alexaTimers.length > 0) {\n        const firstActiveTimer = alexaTimers.find(entityId => {\n          const timerData = TimerEntityService.getTimerData(entityId, hass);\n          return timerData && timerData.isActive;\n        });\n        \n        if (firstActiveTimer) {\n          const timerData = TimerEntityService.getTimerData(firstActiveTimer, hass);\n          if (timerData) {\n            return TimerEntityService.getTimerSubtitle(timerData, config.show_seconds !== false);\n          }\n        } else if (alexaTimers.length > 0) {\n          // Show info about available but inactive timers\n          return `${alexaTimers.length} Alexa timer${alexaTimers.length === 1 ? '' : 's'} available`;\n        }\n      }\n    }\n    \n    if (this.expired) {\n      const { expired_text = 'Completed! ' } = config;\n      return expired_text;\n    }\n    \n    const { months, days, hours, minutes, seconds } = this.timeRemaining || { months: 0, days: 0, hours: 0, minutes: 0, seconds: 0 };\n    const { show_months, show_days, show_hours, show_minutes, show_seconds } = config;\n    \n    const parts = [];\n    \n    // Add each time unit based on configuration and if value > 0\n    if (show_months && months > 0) {\n      parts.push({ value: months, unit: months === 1 ? 'month' : 'months' });\n    }\n    \n    if (show_days && days > 0) {\n      parts.push({ value: days, unit: days === 1 ? 'day' : 'days' });\n    }\n    \n    if (show_hours && hours > 0) {\n      parts.push({ value: hours, unit: hours === 1 ? 'hour' : 'hours' });\n    }\n    \n    if (show_minutes && minutes > 0) {\n      parts.push({ value: minutes, unit: minutes === 1 ? 'minute' : 'minutes' });\n    }\n    \n    if (show_seconds && seconds > 0) {\n      parts.push({ value: seconds, unit: seconds === 1 ? 'second' : 'seconds' });\n    }\n    \n    // If no parts are shown or all values are 0, show the largest enabled unit\n    if (parts.length === 0) {\n      if (show_months) {\n        parts.push({ value: months, unit: months === 1 ? 'month' : 'months' });\n      } else if (show_days) {\n        parts.push({ value: days, unit: days === 1 ? 'day' : 'days' });\n      } else if (show_hours) {\n        parts.push({ value: hours, unit: hours === 1 ? 'hour' : 'hours' });\n      } else if (show_minutes) {\n        parts.push({ value: minutes, unit: minutes === 1 ? 'minute' : 'minutes' });\n      } else if (show_seconds) {\n        parts.push({ value: seconds, unit: seconds === 1 ? 'second' : 'seconds' });\n      }\n    }\n    \n    // Count enabled units for formatting decision\n    const enabledUnits = [show_months, show_days, show_hours, show_minutes, show_seconds].filter(Boolean).length;\n    \n    // Format based on number of enabled units\n    if (enabledUnits <= 2 && parts.length > 0) {\n      // Natural format for 1-2 enabled units: \"1 month and 10 days\"\n      if (parts.length === 1) {\n        return `${parts[0].value} ${parts[0].unit}`;\n      } else if (parts.length === 2) {\n        return `${parts[0].value} ${parts[0].unit} and ${parts[1].value} ${parts[1].unit}`;\n      }\n    }\n    \n    // Compact format for 3+ enabled units: \"1mo 10d 5h\"\n    return parts.map(part => {\n      const shortUnit = part.unit.charAt(0); // m, d, h, m, s\n      return `${part.value}${shortUnit}`;\n    }).join(' ') || '0s';\n  }\n\n  /**\n   * Converts TimerData to CountdownState for unified interface\n   */\n  private _timerDataToCountdownState(timerData: any): CountdownState {\n    return {\n      months: 0,\n      days: 0,\n      hours: Math.floor(timerData.remaining / 3600),\n      minutes: Math.floor((timerData.remaining % 3600) / 60),\n      seconds: Math.floor(timerData.remaining % 60),\n      total: timerData.remaining * 1000 // ms for consistency\n    };\n  }\n\n  /**\n   * Gets current time remaining\n   * @returns {Object} - Time remaining object\n   */\n  getTimeRemaining(): CountdownState {\n    return this.timeRemaining;\n  }\n\n  /**\n   * Gets expired status\n   * @returns {boolean} - Whether countdown has expired\n   */\n  isExpired(): boolean {\n    return this.expired;\n  }\n\n  /**\n   * Gets available Alexa timers for debugging/info\n   * @param {Object} hass - Home Assistant object\n   * @returns {string[]} - Array of Alexa timer entity IDs\n   */\n  getAvailableAlexaTimers(hass: HomeAssistant | null): string[] {\n    if (!hass) return [];\n    return TimerEntityService.discoverAlexaTimers(hass);\n  }\n\n  /**\n   * Get the current timer entity being used (for default actions)\n   */\n  getCurrentTimerEntity(config: any, hass: any): string | null {\n    // If explicit timer entity is configured, use it\n    if (config.timer_entity) {\n      return config.timer_entity;\n    }\n\n    // If auto-discovery is enabled, try to find the best Alexa timer\n    if (config.auto_discover_alexa && hass) {\n      const alexaTimers = TimerEntityService.discoverAlexaTimers(hass);\n      if (alexaTimers.length > 0) {\n        // Find the first active timer, or return the first timer if none are active\n        for (const entityId of alexaTimers) {\n          const timerData = TimerEntityService.getTimerData(entityId, hass);\n          if (timerData && timerData.isActive) {\n            return entityId;\n          }\n        }\n        // No active timers found, return the first one\n        return alexaTimers[0];\n      }\n    }\n\n    return null;\n  }\n}","/**\n * StyleManager - Handles styling calculations and CSS processing\n * Provides dynamic sizing, proportional scaling, and style management\n */\nexport class StyleManager {\n  // Constants for icon and stroke size limits\n  static MIN_ICON_SIZE = 40;\n  static MAX_ICON_SIZE = 300;  // Increased from 120 to 300\n  static MIN_STROKE = 4;\n  static MAX_STROKE = 50;      // Increased from 20 to 50\n\n  private cache: {\n    dynamicIconSize: number | null;\n    dynamicStrokeWidth: number | null;\n    customStyles: any | null;\n    lastConfigHash: string | null;\n    lastIconConfigHash?: string | null;\n    lastStrokeConfigHash?: string | null;\n  };\n\n  constructor() {\n    this.cache = {\n      dynamicIconSize: null,\n      dynamicStrokeWidth: null,\n      customStyles: null,\n      lastConfigHash: null\n    };\n  }\n\n  /**\n   * Processes styles array into CSS string\n   * @param {Array} styles - Array of style objects or strings\n   * @returns {string} - CSS string\n   */\n  processStyles(styles: any[]): string {\n    if (!styles || !Array.isArray(styles)) return '';\n    \n    return styles.map(style => {\n      try {\n        if (typeof style === 'string') {\n          return style;\n        } else if (typeof style === 'object' && style !== null) {\n          return Object.entries(style)\n            .map(([prop, value]) => `${prop}: ${value}`)\n            .join('; ');\n        }\n        return '';\n      } catch (e) {\n        return '';\n      }\n    }).join('; ');\n  }\n\n  /**\n   * Builds styles object from configuration\n   * @param {Object} config - Card configuration\n   * @returns {Object} - Processed styles object\n   */\n  buildStylesObject(config: any): any {\n    // Use cached value if available and config hasn't changed\n    const configHash = JSON.stringify(config.styles || {});\n    if (this.cache.customStyles !== null && this.cache.lastConfigHash === configHash) {\n      return this.cache.customStyles;\n    }\n\n    const { styles = {} } = config;\n    \n    try {\n      const processedStyles = {\n        card: this.processStyles(styles.card),\n        title: this.processStyles(styles.title),\n        subtitle: this.processStyles(styles.subtitle),\n        progress_circle: this.processStyles(styles.progress_circle)\n      };\n\n      this.cache.customStyles = processedStyles;\n      this.cache.lastConfigHash = configHash;\n      return processedStyles;\n    } catch (e) {\n      this.cache.customStyles = {\n        card: '',\n        title: '',\n        subtitle: '',\n        progress_circle: ''\n      };\n      return this.cache.customStyles;\n    }\n  }\n\n  /**\n   * Internal helper to get card dimensions based on width, height, and aspect ratio\n   */\n  _getCardDimensions(width: any, height: any, aspect_ratio: any): any {\n    const defaultWidth = 300;\n    const defaultHeight = 150;\n    let cardWidth = defaultWidth;\n    let cardHeight = defaultHeight;\n    if (width && height) {\n      const parsedW = this.parseDimension(width);\n      const parsedH = this.parseDimension(height);\n      cardWidth = parsedW || defaultWidth;\n      cardHeight = parsedH || defaultHeight;\n    } else if (width && aspect_ratio) {\n      const parsedW = this.parseDimension(width);\n      cardWidth = parsedW || defaultWidth;\n      const [ratioW, ratioH] = aspect_ratio.split('/').map(parseFloat);\n      if (!isNaN(ratioW) && !isNaN(ratioH) && ratioW > 0) {\n        cardHeight = cardWidth * (ratioH / ratioW);\n      }\n    } else if (height && aspect_ratio) {\n      const parsedH = this.parseDimension(height);\n      cardHeight = parsedH || defaultHeight;\n      const [ratioW, ratioH] = aspect_ratio.split('/').map(parseFloat);\n      if (!isNaN(ratioW) && !isNaN(ratioH) && ratioH > 0) {\n        cardWidth = cardHeight * (ratioW / ratioH);\n      }\n    } else if (aspect_ratio) {\n      const [ratioW, ratioH] = aspect_ratio.split('/').map(parseFloat);\n      if (!isNaN(ratioW) && !isNaN(ratioH) && ratioW > 0) {\n        cardHeight = defaultWidth * (ratioH / ratioW);\n      }\n      cardWidth = defaultWidth;\n    }\n    if (!cardWidth || isNaN(cardWidth) || cardWidth <= 0) cardWidth = defaultWidth;\n    if (!cardHeight || isNaN(cardHeight) || cardHeight <= 0) cardHeight = defaultHeight;\n    return { cardWidth, cardHeight };\n  }\n\n  /**\n   * Calculate dynamic icon size based on card dimensions - now truly proportional\n   * @param {*} width - Card width\n   * @param {*} height - Card height\n   * @param {string} aspect_ratio - Aspect ratio string\n   * @param {*} icon_size - Explicit icon size\n   * @returns {number} - Calculated icon size in pixels\n   */\n  calculateDynamicIconSize(width: any, height: any, aspect_ratio: any, icon_size: any): number {\n    // Use cached value if available and config hasn't changed\n    const configKey = JSON.stringify({ width, height, aspect_ratio, icon_size });\n    if (this.cache.dynamicIconSize !== null && this.cache.lastIconConfigHash === configKey) {\n      return this.cache.dynamicIconSize;\n    }\n\n    try {\n      const { cardWidth, cardHeight } = this._getCardDimensions(width, height, aspect_ratio);\n      const minDimension = Math.min(cardWidth, cardHeight);\n      const proportionalSize = minDimension * 0.4;\n      let size = proportionalSize;\n\n      // Respect explicit icon_size if provided, otherwise use proportional\n      if (icon_size && icon_size !== '100px') {\n        const baseSize = typeof icon_size === 'string' ?\n          parseInt(icon_size.replace('px', '')) :\n          (typeof icon_size === 'number' ? icon_size : proportionalSize);\n        // If explicit size is provided, use it directly (within max limit)\n        size = (!isNaN(baseSize)) ? baseSize : proportionalSize;\n      }\n\n      this.cache.dynamicIconSize = Math.max(StyleManager.MIN_ICON_SIZE, Math.min(size, StyleManager.MAX_ICON_SIZE));\n      this.cache.lastIconConfigHash = configKey;\n      return this.cache.dynamicIconSize;\n    } catch (error) {\n      this.cache.dynamicIconSize = StyleManager.MIN_ICON_SIZE; // Safe fallback\n      return this.cache.dynamicIconSize;\n    }\n  }\n\n  /**\n   * Calculate dynamic stroke width based on icon size\n   * @param {number} iconSize - Icon size in pixels\n   * @param {*} stroke_width - Explicit stroke width\n   * @returns {number} - Calculated stroke width\n   */\n  calculateDynamicStrokeWidth(iconSize: any, stroke_width: any): number {\n    // Use cached value if available and config hasn't changed\n    const configKey = JSON.stringify({ iconSize, stroke_width });\n    if (this.cache.dynamicStrokeWidth !== null && this.cache.lastStrokeConfigHash === configKey) {\n      return this.cache.dynamicStrokeWidth;\n    }\n\n    try {\n      // If explicit stroke_width is provided, use it directly\n      if (stroke_width && typeof stroke_width === 'number') {\n        this.cache.dynamicStrokeWidth = Math.max(StyleManager.MIN_STROKE, Math.min(stroke_width, StyleManager.MAX_STROKE));\n      } else {\n        // Otherwise calculate proportional stroke based on icon size\n        const ratio = 0.15;\n        const calculated = Math.round(iconSize * ratio);\n        this.cache.dynamicStrokeWidth = Math.max(StyleManager.MIN_STROKE, Math.min(calculated, StyleManager.MAX_STROKE));\n      }\n      \n      this.cache.lastStrokeConfigHash = configKey;\n      return this.cache.dynamicStrokeWidth;\n    } catch (error) {\n      this.cache.dynamicStrokeWidth = StyleManager.MIN_STROKE; // Safe fallback\n      return this.cache.dynamicStrokeWidth;\n    }\n  }\n\n  /**\n   * Calculate proportional font sizes based on card dimensions\n   * @param {*} width - Card width\n   * @param {*} height - Card height\n   * @param {string} aspect_ratio - Aspect ratio string\n   * @returns {Object} - Object with font sizes and dimensions\n   */\n  calculateProportionalSizes(width: any, height: any, aspect_ratio: any): any {\n    try {\n      const { cardWidth, cardHeight } = this._getCardDimensions(width, height, aspect_ratio);\n      const defaultArea = 300 * 150;\n      const scaleFactor = Math.sqrt((cardWidth * cardHeight) / defaultArea);\n\n      return {\n        titleSize: Math.max(1.2, Math.min(2.2, 1.6 * scaleFactor)),\n        subtitleSize: Math.max(0.9, Math.min(1.4, 1.1 * scaleFactor)),\n        cardWidth,\n        cardHeight\n      };\n    } catch (error) {\n      return { titleSize: 1.6, subtitleSize: 1.1, cardWidth: 300, cardHeight: 150 };\n    }\n  }\n\n  /**\n   * Helper to parse dimension strings (e.g., \"200px\", \"100%\") to numbers\n   * @param {*} dimension - Dimension value to parse\n   * @returns {number|null} - Parsed dimension in pixels\n   */\n  parseDimension(dimension: any): number | null {\n    try {\n      if (typeof dimension === 'number') return dimension;\n      if (typeof dimension !== 'string') return null;\n      // Normalize string for case-insensitive matching\n      const dimStr = dimension.toLowerCase();\n      // Handle percentage values - assume 300px base for calculations\n      if (dimStr.includes('%')) {\n        const percent = parseFloat(dimStr.replace('%', ''));\n        return isNaN(percent) ? null : (percent / 100) * 300; // 300px as base\n      }\n      // Handle pixel values\n      if (dimStr.includes('px')) {\n        const pixels = parseFloat(dimStr.replace('px', ''));\n        return isNaN(pixels) ? null : pixels;\n      }\n      // Try to parse as number\n      const parsed = parseFloat(dimStr);\n      return isNaN(parsed) ? null : parsed;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Generates card dimensions CSS based on configuration\n   * @param {*} width - Card width\n   * @param {*} height - Card height\n   * @param {string} aspect_ratio - Aspect ratio string\n   * @returns {Array} - Array of CSS style strings\n   */\n  generateCardDimensionStyles(width: any, height: any, aspect_ratio: any): string[] {\n    const cardStyles = [];\n    \n    // Apply width if specified\n    if (width) {\n      const formattedWidth = this._formatDimensionValue(width);\n      if (formattedWidth) {\n        cardStyles.push(`width: ${formattedWidth}`);\n      }\n    }\n    \n    // Apply height if specified\n    if (height) {\n      const formattedHeight = this._formatDimensionValue(height);\n      if (formattedHeight) {\n        cardStyles.push(`height: ${formattedHeight}`);\n      }\n    } else if (aspect_ratio && !height) {\n      // Use aspect-ratio if height not specified\n      cardStyles.push(`aspect-ratio: ${aspect_ratio}`);\n    }\n    \n    // Add a minimum height if no height or aspect ratio is specified\n    if (!height && !aspect_ratio) {\n      cardStyles.push('min-height: 120px');\n    }\n\n    return cardStyles;\n  }\n\n  /**\n   * Helper method to format dimension values with proper units\n   * @param {*} value - The dimension value (string or number)\n   * @returns {string|null} - Formatted CSS value or null if invalid\n   */\n  private _formatDimensionValue(value: any): string | null {\n    if (!value) return null;\n    \n    const strValue = String(value).trim();\n    \n    // If it already has units (px, %, em, rem, vh, vw, etc.), use as-is\n    if (/^[\\d.]+\\s*(px|%|em|rem|vh|vw|vmin|vmax|ch|ex)$/i.test(strValue)) {\n      return strValue;\n    }\n    \n    // If it's a pure number, add 'px' unit\n    const numValue = parseFloat(strValue);\n    if (!isNaN(numValue)) {\n      return `${numValue}px`;\n    }\n    \n    // Invalid value\n    return null;\n  }\n\n  /**\n   * Clears style cache\n   */\n  clearCache() {\n    this.cache = {\n      dynamicIconSize: null,\n      dynamicStrokeWidth: null,\n      customStyles: null,\n      lastConfigHash: null\n    };\n  }\n\n  /**\n   * Public method to get card dimensions based on configuration\n   * @param {*} width - Card width\n   * @param {*} height - Card height\n   * @param {string} aspect_ratio - Aspect ratio string\n   * @returns {Object} - Object with cardWidth and cardHeight\n   */\n  getCardDimensions(width: any, height: any, aspect_ratio: any): { cardWidth: number; cardHeight: number } {\n    return this._getCardDimensions(width, height, aspect_ratio);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=t=>(...e)=>({_$litDirective$:t,values:e});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}export{i as Directive,t as PartType,e as directive};\n//# sourceMappingURL=directive.js.map\n","/**\n * Action Handler utilities for TimeFlow Card\n * Based on timer-bar-card implementation for Home Assistant action handling\n */\n\nimport { HomeAssistant, ActionConfig, ActionHandlerEvent, CardConfig } from '../types/index';\nimport { html, TemplateResult } from 'lit';\nimport { directive, Directive, PartInfo } from 'lit/directive.js';\nimport { noChange } from 'lit';\n\n/**\n * Check if an action is configured\n */\nexport function hasAction(config?: ActionConfig): boolean {\n  return config !== undefined && config.action !== 'none';\n}\n\n/**\n * Fire a custom event on an element\n */\nexport function fireEvent(\n  node: HTMLElement,\n  type: string,\n  detail?: any,\n  options?: { bubbles?: boolean; cancelable?: boolean; composed?: boolean }\n): void {\n  const event = new CustomEvent(type, {\n    bubbles: options?.bubbles || true,\n    cancelable: options?.cancelable || true,\n    composed: options?.composed || true,\n    detail,\n  });\n  node.dispatchEvent(event);\n}\n\n/**\n * Handle action execution - fires hass-action event for Home Assistant to handle\n */\nexport function handleAction(\n  node: HTMLElement,\n  hass: HomeAssistant,\n  config: CardConfig,\n  action: 'tap' | 'hold' | 'double_tap'\n): void {\n  let actionConfig: ActionConfig | undefined;\n\n  switch (action) {\n    case 'tap':\n      actionConfig = config.tap_action;\n      break;\n    case 'hold':\n      actionConfig = config.hold_action;\n      break;\n    case 'double_tap':\n      actionConfig = config.double_tap_action;\n      break;\n  }\n\n  if (!actionConfig || actionConfig.action === 'none') {\n    return;\n  }\n\n  // Fire hass-action event that Home Assistant will handle\n  fireEvent(node, 'hass-action', { config: actionConfig, action });\n}\n\n/**\n * Create action handler function for event binding\n */\nexport function createHandleAction(hass: HomeAssistant, config: CardConfig) {\n  return (ev: ActionHandlerEvent) => {\n    handleAction(ev.target as HTMLElement, hass, config, ev.detail.action);\n  };\n}\n\n/**\n * Action handler directive for touch/click events\n */\nclass ActionHandlerDirective extends Directive {\n  private element?: HTMLElement;\n  private options: { hasHold?: boolean; hasDoubleClick?: boolean } = {};\n  \n  private boundHandleStart = this.handleStart.bind(this);\n  private boundHandleEnd = this.handleEnd.bind(this);\n  private boundHandleClick = this.handleClick.bind(this);\n  \n  private holdTimeout?: number;\n  private clickTimeout?: number;\n  private clickCount = 0;\n  private isHolding = false;\n\n  render(options: { hasHold?: boolean; hasDoubleClick?: boolean } = {}) {\n    return noChange;\n  }\n\n  update(part: any, [options]: [{ hasHold?: boolean; hasDoubleClick?: boolean }]) {\n    const element = part.element as HTMLElement;\n    \n    if (this.element !== element) {\n      this.cleanup();\n      this.element = element;\n      this.options = options || {};\n      this.setupListeners();\n    } else if (JSON.stringify(this.options) !== JSON.stringify(options)) {\n      this.options = options || {};\n    }\n    \n    return noChange;\n  }\n\n  private setupListeners() {\n    if (!this.element) return;\n\n    // Add touch and mouse event listeners\n    this.element.addEventListener('touchstart', this.boundHandleStart, { passive: true });\n    this.element.addEventListener('mousedown', this.boundHandleStart);\n    this.element.addEventListener('click', this.boundHandleClick);\n    \n    // Prevent context menu on long press for mobile\n    this.element.addEventListener('contextmenu', (e) => {\n      if (this.isHolding) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    });\n  }\n\n  private cleanup() {\n    if (!this.element) return;\n\n    this.element.removeEventListener('touchstart', this.boundHandleStart);\n    this.element.removeEventListener('mousedown', this.boundHandleStart);\n    this.element.removeEventListener('click', this.boundHandleClick);\n    \n    this.clearTimeouts();\n  }\n\n  private clearTimeouts() {\n    if (this.holdTimeout) {\n      clearTimeout(this.holdTimeout);\n      this.holdTimeout = undefined;\n    }\n    if (this.clickTimeout) {\n      clearTimeout(this.clickTimeout);\n      this.clickTimeout = undefined;\n    }\n  }\n\n  private handleStart(e: TouchEvent | MouseEvent) {\n    this.isHolding = false;\n    \n    if (this.options.hasHold) {\n      this.holdTimeout = window.setTimeout(() => {\n        this.isHolding = true;\n        this.fireAction('hold');\n      }, 500); // 500ms hold threshold\n    }\n\n    // Add end event listeners\n    const handleEnd = () => {\n      this.clearTimeouts();\n      document.removeEventListener('touchend', handleEnd);\n      document.removeEventListener('mouseup', handleEnd);\n      document.removeEventListener('touchcancel', handleEnd);\n    };\n\n    document.addEventListener('touchend', handleEnd, { passive: true });\n    document.addEventListener('mouseup', handleEnd);\n    document.addEventListener('touchcancel', handleEnd, { passive: true });\n  }\n\n  private handleEnd() {\n    this.clearTimeouts();\n  }\n\n  private handleClick(e: MouseEvent) {\n    // Prevent click if we just completed a hold action\n    if (this.isHolding) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.isHolding = false;\n      return;\n    }\n\n    if (this.options.hasDoubleClick) {\n      this.clickCount++;\n      \n      if (this.clickCount === 1) {\n        this.clickTimeout = window.setTimeout(() => {\n          if (this.clickCount === 1) {\n            this.fireAction('tap');\n          }\n          this.clickCount = 0;\n        }, 250); // 250ms double-click threshold\n      } else if (this.clickCount === 2) {\n        this.clearTimeouts();\n        this.fireAction('double_tap');\n        this.clickCount = 0;\n      }\n    } else {\n      this.fireAction('tap');\n    }\n  }\n\n  private fireAction(action: 'tap' | 'hold' | 'double_tap') {\n    if (!this.element) return;\n    \n    fireEvent(this.element, 'action', { action });\n  }\n\n  disconnected() {\n    this.cleanup();\n  }\n}\n\n/**\n * Action handler directive factory\n */\nexport const actionHandlerDirective = directive(ActionHandlerDirective);\n\n/**\n * Create action handler with configuration\n */\nexport function createActionHandler(config: CardConfig) {\n  return actionHandlerDirective({\n    hasHold: hasAction(config.hold_action),\n    hasDoubleClick: hasAction(config.double_tap_action),\n  });\n}\n","import { LitElement, html, css, TemplateResult, CSSResult } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nexport interface ValidationError {\n  field: string;\n  message: string;\n  severity: 'critical' | 'warning' | 'info';\n  suggestion?: string;\n  value?: any;\n}\n\nexport class ErrorDisplay extends LitElement {\n  @property({ type: Array }) errors: ValidationError[] = [];\n  @property({ type: String }) title: string = 'Configuration Issues';\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        font-family: var(--font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif);\n      }\n\n      .error-container {\n        background: #332022;\n        border: 1px solid #582533ff;\n        border-radius: 1px;\n        padding: 16px;\n        margin: 8px;\n        color: #ffffff;\n      }\n\n      .error-list {\n        list-style: none;\n        padding: 0;\n        margin: 0;\n      }\n\n      .error-item {\n        margin-bottom: 8px;\n        line-height: 1.4;\n      }\n\n      .error-field {\n        font-weight: 600;\n        color: #D74133;\n      }\n    `;\n  }\n\n  render(): TemplateResult {\n    if (!this.errors || this.errors.length === 0) {\n      return html``;\n    }\n\n    // Filter out info messages, only show critical and warning\n    const relevantErrors = this.errors.filter(e => e.severity === 'critical' || e.severity === 'warning');\n    \n    if (relevantErrors.length === 0) {\n      return html``;\n    }\n\n    return html`\n      <div class=\"error-container\">\n        <ul class=\"error-list\">\n          ${relevantErrors.map(error => html`\n            <li class=\"error-item\">\n              <span class=\"error-field\">${error.field}:</span> ${error.message}\n            </li>\n          `)}\n        </ul>\n      </div>\n    `;\n  }\n}\n\n// Register the custom element\ncustomElements.define('error-display', ErrorDisplay);\n","//TimeFlowCardBeta.ts\nimport { LitElement, html, css, TemplateResult, CSSResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { TimerEntityService } from '../services/Timer';\nimport { DateParser } from '../utils/DateParser';\nimport { ConfigValidator, ValidationResult, ValidationError } from '../utils/ConfigValidator';\nimport { TemplateService } from '../services/TemplateService';\nimport { CountdownService } from '../services/CountdownService';\nimport { StyleManager } from '../utils/StyleManager';\nimport { HomeAssistant, CountdownState, CardConfig } from '../types/index';\nimport { createActionHandler, createHandleAction } from '../utils/ActionHandler';\nimport '../utils/ErrorDisplay';\n\nexport class TimeFlowCardBeta extends LitElement {\n  // Reactive properties to trigger updates\n  @property({ type: Object }) hass: HomeAssistant | null = null;\n  @property({ type: Object }) config: CardConfig = this.getStubConfig();\n\n  // Internal reactive state for resolved config props and countdown state\n  @state() private _resolvedConfig: CardConfig = this.getStubConfig();\n  @state() private _progress: number = 0;\n  @state() private _countdown: CountdownState = {\n    months: 0,\n    days: 0,\n    hours: 0,\n    minutes: 0,\n    seconds: 0,\n    total: 0\n  };\n  @state() private _expired: boolean = false;\n  @state() private _validationResult: ValidationResult | null = null;\n  @state() private _initialized: boolean = false; // Track initialization\n\n  // Timer ID\n  private _timerId: ReturnType<typeof setInterval> | null = null;\n\n  // Services instances (could be injected if needed)\n  private templateService = new TemplateService();\n  private countdownService = new CountdownService(this.templateService, DateParser);\n  private styleManager = new StyleManager();\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;\n        color: var(--primary-text-color, #222);\n        --progress-color: var(--progress-color, #4caf50);\n      }\n      \n      /* FIXED: Set initial background immediately to prevent white flash */\n      ha-card {\n        display: flex;\n        flex-direction: column;\n        padding: 0;\n        border-radius: 22px;\n        position: relative;\n        overflow: hidden;\n        /* IMPORTANT: Set default background immediately */\n        background: var(--card-background, var(--primary-background-color, #1a1a1a));\n        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n        border: none;\n        /* REMOVED: transition that causes flash - only animate specific properties if needed */\n        /* transition: background-color 0.3s ease; */\n        min-height: 120px; /* Prevent layout shift */\n        user-select: none; /* Prevent text selection during interactions */\n      }\n      \n      /* Make card interactive when actions are configured */\n      ha-card[actionHandler] {\n        cursor: pointer;\n      }\n      \n      ha-card[actionHandler]:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);\n        transition: transform 0.2s ease, box-shadow 0.2s ease;\n      }\n      \n      ha-card[actionHandler]:active {\n        transform: translateY(0);\n        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n      }\n      \n      /* Error message styling */\n      .error {\n        color: #721c24;\n        padding: 12px;\n        border-radius: 16px;\n        white-space: pre-wrap;\n        word-break: break-word;\n      }\n      \n      /* FIXED: Only show card after initialization to prevent white flash */\n      ha-card:not(.initialized) {\n        opacity: 0;\n      }\n      \n      ha-card.initialized {\n        opacity: 1;\n        transition: opacity 0.2s ease-in;\n      }\n      \n      ha-card.expired {\n        animation: celebration 0.8s ease-in-out;\n      }\n      \n      .card-content {\n        display: flex;\n        flex-direction: column;\n        justify-content: space-between;\n        padding: 20px;\n        height: 100%;\n        /* FIXED: Ensure content has proper background inheritance */\n        background: inherit;\n      }\n      \n      .header {\n        display: flex;\n        justify-content: space-between;\n        align-items: flex-start;\n        margin-bottom: 0;\n      }\n      \n      .title-section {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        gap: 2px;\n      }\n      \n      .title {\n        font-size: var(--timeflow-title-size, 1.5rem);\n        font-weight: 500;\n        margin: 0;\n        opacity: 0.9;\n        line-height: 1.3;\n        letter-spacing: -0.01em;\n        color: var(--timeflow-card-text-color, inherit);\n      }\n      \n      .subtitle {\n        font-size: var(--timeflow-subtitle-size, 1rem);\n        opacity: 0.65;\n        margin: 0;\n        font-weight: 400;\n        line-height: 1.2;\n        color: var(--timeflow-card-text-color, inherit);\n      }\n      \n      .progress-section {\n        flex-shrink: 0;\n        margin-left: auto;\n      }\n      \n      .content {\n        display: flex;\n        align-items: flex-end;\n        justify-content: flex-end;\n        margin-top: auto;\n        padding-top: 12px;\n      }\n      \n      .progress-circle {\n        opacity: 0.9;\n      }\n      \n      @keyframes celebration {\n        0% { transform: scale(1); }\n        50% { transform: scale(1.05); }\n        100% { transform: scale(1); }\n      }\n      \n      /* Dark mode support */\n      @media (prefers-color-scheme: dark) {\n        ha-card {\n          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n        }\n      }\n    `;\n  }\n\n  constructor() {\n    super();\n    // Initialize with proper stub config\n    const stubConfig = this.getStubConfig();\n    this.config = stubConfig;\n    this._resolvedConfig = stubConfig;\n  }\n\n  // Provide default configuration stub (like original)\n  static getStubConfig(): CardConfig {\n    return {\n      type: 'custom:timeflow-card-beta',\n      target_date: '2025-12-31T23:59:59',\n      creation_date: '2024-12-31T23:59:59',\n      timer_entity: '',\n      title: 'New Year Countdown',\n      show_days: true,\n      show_hours: true,\n      show_minutes: true,\n      show_seconds: true,\n      progress_color: '#C0F950',\n      background_color: \"#1a1a1a\",\n      stroke_width: 15,\n      icon_size: 100,\n      expired_animation: true,\n      expired_text: 'Completed! ',\n      show_progress_text: false, // FIXED: Added to stub config\n    };\n  }\n\n  // Instance method for internal use\n  getStubConfig(): CardConfig {\n    return TimeFlowCardBeta.getStubConfig();\n  }\n\n  setConfig(config: CardConfig): void {\n    try {\n      // Validate the config with new enhanced validation\n      const validationResult = ConfigValidator.validateConfig(config);\n      this._validationResult = validationResult;\n      \n      // Determine if we should proceed with the configuration\n      if (validationResult.hasCriticalErrors) {\n        // Use safe config if available, otherwise use stub config\n        this.config = validationResult.safeConfig || this.getStubConfig();\n        this._resolvedConfig = { ...this.config };\n      } else if (validationResult.hasWarnings) {\n        // Configuration has warnings - don't proceed with normal flow\n        this.config = { ...config };\n        this._resolvedConfig = { ...config };\n        this._initialized = true; // Set as initialized to show the warning\n        this.requestUpdate();\n        return; // Don't proceed with countdown updates\n      } else {\n        // Configuration is valid\n        this.config = { ...config };\n        this._resolvedConfig = { ...config };\n      }\n      \n      this._initialized = false; // Reset initialization flag\n      this.templateService.clearTemplateCache();\n      this.styleManager.clearCache();\n      \n      // Trigger immediate update after config change\n      this._updateCountdownAndRender().then(() => {\n        this._initialized = true;\n        this.requestUpdate();\n      });\n    } catch (err) {\n      // Handle unexpected validation errors\n      \n      // Create a validation result for unexpected errors\n      this._validationResult = {\n        isValid: false,\n        errors: [{\n          field: 'config',\n          message: (err as Error).message || 'Unexpected configuration error',\n          severity: 'critical',\n          suggestion: 'Check console for details and verify your configuration syntax.',\n          value: config\n        }],\n        hasCriticalErrors: true,\n        hasWarnings: false,\n        safeConfig: this.getStubConfig()\n      };\n      \n      this.config = this.getStubConfig();\n      this._resolvedConfig = { ...this.config };\n      this._initialized = true; // Make sure we're initialized to render the error\n      \n      // Force update to show error message\n      this.requestUpdate();\n    }\n  }\n\n  // Lit lifecycle: Called when component is first updated after initial render\n  firstUpdated(): void {\n    // Set up template service with card reference\n    this.templateService.card = this;\n    \n    // FIXED: Initialize immediately on first update\n    this._updateCountdownAndRender().then(() => {\n      this._initialized = true;\n      this.requestUpdate();\n      this._startCountdownUpdates();\n    });\n  }\n\n  // Cleanup on disconnect\n  disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._stopCountdownUpdates();\n  }\n\n  updated(changedProperties: Map<string | number | symbol, unknown>): void {\n    if (changedProperties.has('hass') || changedProperties.has('config')) {\n      // Clear template caches on hass or config changes\n      this.templateService.clearTemplateCache();\n      this._updateCountdownAndRender();\n    }\n  }\n\n  /**\n   * Starts ticking the countdown every second\n   */\n  _startCountdownUpdates(): void {\n    this._stopCountdownUpdates(); // clear previous interval\n    this._timerId = setInterval(() => {\n      this._updateCountdownAndRender();\n    }, 1000);\n  }\n\n  /**\n   * Clears the countdown update timer\n   */\n  _stopCountdownUpdates(): void {\n    if (this._timerId) {\n      clearInterval(this._timerId);\n      this._timerId = null;\n    }\n  }\n\n  /**\n   * Resolves templates and updates countdown data, then requests re-render\n   */\n  async _updateCountdownAndRender() {\n    // If we have critical configuration errors, skip updates\n    if (this._validationResult?.hasCriticalErrors) return;\n\n    // Clone config for resolution\n    const resolvedConfig = { ...this.config };\n\n    // List of config keys that can be templates\n    const templateKeys = [\n      'target_date',\n      'creation_date',\n      'timer_entity',\n      'title',\n      'subtitle',\n      'color',\n      'background_color',\n      'progress_color',\n      'primary_color',\n      'secondary_color',\n      'expired_text'\n    ] as const;\n\n    // Resolve templates where applicable\n    for (const key of templateKeys) {\n      if (typeof resolvedConfig[key] === 'string' && this.templateService.isTemplate(resolvedConfig[key] as string)) {\n        const resolvedValue = await this.templateService.resolveValue(resolvedConfig[key] as string);\n        resolvedConfig[key] = resolvedValue || undefined;\n      }\n    }\n\n    // Store resolved config in reactive state\n    this._resolvedConfig = resolvedConfig;\n\n    // Calculate countdown data\n    await this.countdownService.updateCountdown(resolvedConfig, this.hass);\n\n    // Update countdown state\n    this._countdown = { ...this.countdownService.getTimeRemaining() };\n    this._expired = this.countdownService.isExpired();\n\n    // Calculate progress (0-100)\n    this._progress = await this.countdownService.calculateProgress(resolvedConfig, this.hass);\n\n    this.requestUpdate();\n  }\n\n  render(): TemplateResult {\n    // Handle validation errors and configuration issues\n    if (this._validationResult && !this._validationResult.isValid) {\n      // Show error display for any validation issues (critical errors or warnings)\n      return html`\n        <error-display\n          .errors=\"${this._validationResult.errors}\"\n          .title=\"${this._validationResult.hasCriticalErrors ? 'Configuration Error' : 'Configuration Issues'}\"\n        ></error-display>\n      `;\n    }\n\n    // Render normal card only if validation passed completely\n    return this._renderCard();\n  }\n\n  private _renderCard(): TemplateResult {\n\n    const {\n      title ,\n      subtitle,\n      color,\n      background_color,\n      progress_color,\n      stroke_width ,\n      icon_size ,\n      expired_animation = true,\n      expired_text = 'Completed! ',\n      width,\n      height,\n      aspect_ratio,\n      show_progress_text = false // FIXED: Extract the boolean properly\n    } = this._resolvedConfig;\n\n    // FIXED: Ensure background color has a sensible default\n    const cardBackground = background_color || 'var(--card-background, var(--primary-background-color, #1a1a1a))';\n    const textColor = color || 'var(--primary-text-color, #fff)';\n    const mainProgressColor = progress_color || color || 'var(--progress-color, #4caf50)';\n\n    // Calculate dynamic circle size based on card dimensions to prevent overflow\n    const dynamicCircleSize = this.styleManager.calculateDynamicIconSize(width, height, aspect_ratio, icon_size);\n    const dynamicStroke = this.styleManager.calculateDynamicStrokeWidth(dynamicCircleSize, stroke_width);\n\n    // Calculate proportional text sizes\n    const proportionalSizes = this.styleManager.calculateProportionalSizes(width, height, aspect_ratio);\n\n    // Generate dimension styles for the card\n    const dimensionStyles = this.styleManager.generateCardDimensionStyles(width, height, aspect_ratio);\n    \n    // FIXED: Compose CSS styles with proper background handling\n    const cardStyles = [\n      `background: ${cardBackground}`, \n      `color: ${textColor}`,\n      `--timeflow-card-background-color: ${cardBackground}`,\n      `--timeflow-card-text-color: ${textColor}`,\n      `--timeflow-card-progress-color: ${mainProgressColor}`,\n      `--timeflow-card-icon-size: ${dynamicCircleSize}px`,\n      `--timeflow-card-stroke-width: ${dynamicStroke}`,\n      `--timeflow-title-size: ${proportionalSizes.titleSize}rem`,\n      `--timeflow-subtitle-size: ${proportionalSizes.subtitleSize}rem`,\n      `--progress-text-color: ${textColor}`,\n      ...dimensionStyles\n    ].join('; ');\n\n    // Compose subtitle text\n    const subtitleText = this._expired\n      ? expired_text\n      : (subtitle || (this._resolvedConfig.timer_entity && this.hass\n          ? TimerEntityService.getTimerSubtitle(\n              TimerEntityService.getTimerData(this._resolvedConfig.timer_entity, this.hass)!,\n              this._resolvedConfig.show_seconds !== false\n            )\n          : this.countdownService.getSubtitle(this._resolvedConfig, this.hass)));\n\n    // Compose title text with fallback\n    let titleText = title;\n    if (titleText === undefined || titleText === null || (typeof titleText === 'string' && titleText.trim() === '')) {\n      if (this._resolvedConfig.timer_entity && this.hass) {\n        titleText = TimerEntityService.getTimerTitle(\n          this._resolvedConfig.timer_entity,\n          this.hass\n        );\n      } else {\n        titleText = this._expired ? expired_text : 'Countdown Timer';\n      }\n    }\n\n    // FIXED: Determine card classes including initialization state\n    const cardClasses = [\n      this._initialized ? 'initialized' : '',\n      (this._expired && expired_animation) ? 'expired' : ''\n    ].filter(Boolean).join(' ');\n\n    // Create resolved config with default actions for timer entities\n    const configWithDefaults = { ...this._resolvedConfig };\n    \n    // Add default tap action for timer entities if none is configured\n    if (!configWithDefaults.tap_action) {\n      const currentTimerEntity = this.countdownService.getCurrentTimerEntity(configWithDefaults, this.hass);\n      if (currentTimerEntity) {\n        configWithDefaults.tap_action = {\n          action: 'more-info',\n          entity: currentTimerEntity\n        };\n      }\n    }\n\n    // Check if any actions are configured (including defaults)\n    const hasActions = configWithDefaults.tap_action || configWithDefaults.hold_action || configWithDefaults.double_tap_action;\n\n    return html`\n      <ha-card \n        class=\"${cardClasses}\" \n        style=\"${cardStyles}\"\n        ?actionHandler=${hasActions}\n        .actionHandler=${hasActions ? createActionHandler(configWithDefaults) : undefined}\n        @action=${hasActions && this.hass ? createHandleAction(this.hass, configWithDefaults) : undefined}\n      >\n        <div class=\"card-content\">\n          <header class=\"header\">\n            <div class=\"title-section\">\n              <h2 class=\"title\" aria-live=\"polite\">${titleText}</h2>\n              <p class=\"subtitle\" aria-live=\"polite\">${subtitleText}</p>\n            </div>\n          </header>\n          \n          <div class=\"content\" role=\"group\" aria-label=\"Countdown Progress\">\n            <div class=\"progress-section\">\n              <progress-circle-beta\n                class=\"progress-circle\"\n                .progress=\"${this._progress}\"\n                .color=\"${mainProgressColor}\"\n                .size=\"${dynamicCircleSize}\"\n                .strokeWidth=\"${dynamicStroke}\"\n                .showProgressText=\"${show_progress_text === true}\"\n                aria-label=\"Countdown progress: ${Math.round(this._progress)}%\"\n              ></progress-circle-beta>\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  /**\n   * Helper: Returns card size (in Home Assistant's grid rows approx)\n   */\n  getCardSize(): number {\n    const { aspect_ratio = '2/1', height } = this.config;\n    if (height) {\n      const heightValue = parseInt(typeof height === 'string' ? height : height.toString());\n      if (heightValue <= 100) return 1;\n      if (heightValue <= 150) return 2;\n      if (heightValue <= 200) return 3;\n      return 4;\n    }\n    if (aspect_ratio) {\n      const [width, height] = aspect_ratio.split('/').map(Number);\n      if (!width || !height) return 3;\n      const ratio = height / width;\n      if (ratio >= 1.5) return 4;\n      if (ratio >= 1) return 3;\n      if (ratio >= 0.75) return 2;\n      return 2;\n    }\n    return 3;\n  }\n\n  // Static version info\n  static get version() {\n    return '1.2.0-lit';\n  }\n}","// ProgressCircleBeta.ts\nimport { LitElement, html, css, CSSResult, TemplateResult, PropertyValues } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nexport class ProgressCircleBeta extends LitElement {\n  @property({ type: Number }) progress: number = 0;\n  @property({ type: String }) color: string = '#4CAF50';\n  @property({ type: Number }) size: number = 100;\n  @property({ type: Number }) strokeWidth: number = 15;\n  @property({ type: Boolean }) showProgressText: boolean = false;\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: inline-block;\n        vertical-align: middle;\n      }\n      .progress-wrapper {\n        position: relative;\n      }\n      svg {\n        display: block;\n        margin: 0 auto;\n      }\n      .progress-text {\n        font-size: 16px;  \n        font-weight: bold;\n        fill: var(--progress-text-color, #f4f5f4ff);\n        dominant-baseline: middle;\n        text-anchor: middle;\n        pointer-events: none;\n        user-select: none;\n      }\n      .updating {\n        transition: stroke-dashoffset 0.3s ease;\n      }\n    `;\n  }\n\n  constructor() {\n    super();\n    this.progress = 0;\n    this.color = '#4CAF50';\n    this.size = 100;\n    this.strokeWidth = 15;\n    this.showProgressText = false;\n  }\n\n  updated(changed: PropertyValues): void {\n    // Animate stroke-dashoffset if progress changes\n    if (changed.has('progress')) {\n      const circle = this.renderRoot?.querySelector('.progress-bar') as HTMLElement;\n      if (circle) {\n        circle.classList.add('updating');\n        setTimeout(() => {\n          if (circle) circle.classList.remove('updating');\n        }, 400);\n      }\n    }\n  }\n\n  // Expose imperative API for external modules, as before\n  updateProgress(progress: number, animate: boolean = true): void {\n    if (animate) {\n      this.progress = progress;\n    } else {\n      // Instantly set progress, skips animation\n      const bar = this.renderRoot?.querySelector('.progress-bar') as HTMLElement;\n      this.progress = progress;\n      if (bar) bar.style.transition = 'none';\n      setTimeout(() => { if (bar) bar.style.transition = ''; }, 20);\n    }\n  }\n\n  getProgress(): number {\n    return this.progress;\n  }\n\n  render(): TemplateResult {\n    const safeProgress = Math.max(0, Math.min(100, Number(this.progress) || 0));\n    const size = Number(this.size) || 100;\n    const stroke = Number(this.strokeWidth) || 15;\n    const radius = (size - stroke) / 2;\n    const circumference = 2 * Math.PI * radius;\n    const offset = circumference - (safeProgress / 100) * circumference;\n\n    // Calculate responsive font size based on circle size\n    const fontSize = Math.max(10, Math.min(24, size * 0.16));\n\n    return html`\n      <div class=\"progress-wrapper\" style=\"width:${size}px; height:${size}px;\">\n        <svg\n          class=\"progress-circle-beta\"\n          height=\"${size}\" width=\"${size}\"\n          style=\"overflow:visible;\"\n        >\n          <circle\n            class=\"progress-bg\"\n            cx=\"${size / 2}\" cy=\"${size / 2}\"\n            r=\"${radius}\"\n            fill=\"none\"\n            stroke=\"#FFFFFF1A\"\n            stroke-width=\"${stroke}\"\n          ></circle>\n          <circle\n            class=\"progress-bar\"\n            cx=\"${size / 2}\" cy=\"${size / 2}\"\n            r=\"${radius}\"\n            fill=\"none\"\n            stroke=\"${this.color}\"\n            stroke-width=\"${stroke}\"\n            stroke-linecap=\"round\"\n            style=\"\n              stroke-dasharray: ${circumference};\n              stroke-dashoffset: ${offset};\n              transition: stroke-dashoffset 0.3s ease;\n              transform: rotate(-90deg);\n              transform-origin: ${size / 2}px ${size / 2}px;\n            \"\n          ></circle>\n\n          ${this.showProgressText\n            ? html`\n                <text\n                  x=\"50%\" y=\"50%\"\n                  class=\"progress-text\"\n                  dy=\"2\"\n                  style=\"font-size: ${fontSize}px;\"\n                >\n                  ${Math.round(safeProgress)}%\n                </text>\n              `\n            : html`<!-- showProgressText is false -->`}\n        </svg>\n      </div>\n    `;\n  }\n}","/**\n * TimeFlow Card - Entry point for modular architecture with Lit components\n * Registers Lit-based custom elements and exposes the card to Home Assistant\n */\n\n// Type declarations for Home Assistant globals\ndeclare global {\n  interface Window {\n    customCards?: Array<{\n      type: string;\n      name: string;\n      description: string;\n      preview?: boolean;\n      documentationURL?: string;\n    }>;\n  }\n}\n\nimport { TimeFlowCardBeta } from './components/TimeFlowCard';\nimport { ProgressCircleBeta } from './components/ProgressCircle';\nimport { ErrorDisplay } from './utils/ErrorDisplay';\n\n// Register Lit custom elements with duplicate protection\nif (!customElements.get('error-display')) {\n  customElements.define('error-display', ErrorDisplay);\n} else {\n  // Component already registered\n}\n\nif (!customElements.get('progress-circle-beta')) {\n  customElements.define('progress-circle-beta', ProgressCircleBeta);\n} else {\n  // Component already registered\n}\n\nif (!customElements.get('timeflow-card-beta')) {\n  customElements.define('timeflow-card-beta', TimeFlowCardBeta);\n} else {\n  // Component already registered\n}\n\n// Register the card with Home Assistant\nwindow.customCards = window.customCards || [];\nwindow.customCards.push({\n  type: 'timeflow-card-beta',\n  name: 'TimeFlow Card (Lit Version)',\n  description: 'A beautiful countdown timer card with progress circle for Home Assistant, using Lit',\n  preview: true,\n  documentationURL: 'https://github.com/Rishi8078/TimeFlow-Card' // Update if needed\n});\n\n// Export main classes for external use or testing\nexport { TimeFlowCardBeta, ProgressCircleBeta, ErrorDisplay };"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","SuppressedError","t","globalThis","e","ShadowRoot","ShadyCSS","nativeShadow","Document","prototype","CSSStyleSheet","s","Symbol","o","WeakMap","n$3","constructor","this","_$cssResult$","Error","cssText","styleSheet","get","replaceSync","set","toString","reduce","n","cssRules","is","h","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","a","trustedTypes","l","emptyScript","p","reactiveElementPolyfillSupport","u","toAttribute","Boolean","Array","JSON","stringify","fromAttribute","Number","parse","f","b","attribute","type","String","converter","reflect","useDefault","hasChanged","metadata","litPropertyMetadata","HTMLElement","addInitializer","_$Ei","push","observedAttributes","finalize","_$Eh","keys","createProperty","state","hasOwnProperty","create","wrapped","elementProperties","noAccessor","getPropertyDescriptor","call","requestUpdate","configurable","enumerable","getPropertyOptions","Map","finalized","properties","_$Eu","elementStyles","finalizeStyles","styles","isArray","Set","flat","reverse","unshift","toLowerCase","super","_$Ep","isUpdatePending","hasUpdated","_$Em","_$Ev","_$ES","Promise","enableUpdating","_$AL","_$E_","forEach","addController","_$EO","add","renderRoot","isConnected","hostConnected","removeController","delete","size","createRenderRoot","shadowRoot","attachShadow","shadowRootOptions","adoptedStyleSheets","map","document","createElement","litNonce","setAttribute","textContent","appendChild","connectedCallback","disconnectedCallback","hostDisconnected","attributeChangedCallback","_$AK","_$ET","removeAttribute","_$Ej","hasAttribute","C","_$EP","has","_$Eq","reject","scheduleUpdate","performUpdate","shouldUpdate","willUpdate","hostUpdate","update","_$EM","_$AE","hostUpdated","firstUpdated","updated","updateComplete","getUpdateComplete","y","mode","ReactiveElement","reactiveElementVersions","createPolicy","createHTML","Math","random","toFixed","slice","createComment","v","_","m","RegExp","g","$","x","_$litType$","strings","values","T","for","E","A","createTreeWalker","P","V","lastIndex","exec","test","startsWith","N","parts","el","currentNode","content","firstChild","replaceWith","childNodes","nextNode","nodeType","hasAttributes","getAttributeNames","endsWith","getAttribute","split","index","name","ctor","H","I","L","k","tagName","append","data","indexOf","innerHTML","S","_$Co","_$Cl","_$litDirective$","_$AO","_$AT","_$AS","M","_$AV","_$AN","_$AD","_$AM","parentNode","_$AU","creationScope","importNode","R","nextSibling","z","_$AI","_$Cv","_$AH","_$AA","_$AB","options","startNode","endNode","_$AR","iterator","O","insertBefore","createTextNode","_$AC","_$AP","remove","setConnected","element","fill","j","toggleAttribute","capture","once","passive","removeEventListener","addEventListener","handleEvent","host","litHtmlPolyfillSupport","litHtmlVersions","renderOptions","_$Do","renderBefore","render","_$litPart$","_$litElement$","litElementHydrateSupport","LitElement","litElementPolyfillSupport","litElementVersions","kind","init","TimerEntityService","isTimerEntity","entityId","includes","isAlexaTimer","getTimerData","hass","entity","states","getAlexaTimerData","getStandardTimerData","attributes","remaining","duration","finishesAt","isActive","isISOTimestamp","Date","isNaN","getTime","now","max","floor","parseFloat","parseDuration","hasOriginalDuration","original_duration","progress","elapsed","min","assumedTotalTime","isPaused","alexaDevice","extractAlexaDevice","timerLabel","friendly_name","timer_label","formatAlexaTimerName","isIdle","finishes_at","str","match","replace","device_name","device","toUpperCase","seconds","formatRemainingTime","showSeconds","hours","minutes","padStart","getTimerTitle","customTitle","timerData","getTimerSubtitle","isTimerExpired","getTimerStateColor","defaultColor","discoverAlexaTimers","alexaTimers","DateParser","parseISODate","dateString","manualResult","parseISODateManual","nativeResult","isValidDateResult","parseISODateFallback","dateObj","originalString","timestamp","minTimestamp","maxTimestamp","year","getFullYear","isLeapYear","datePart","timePart","month","day","isValidDateComponents","hour","minute","second","isValidTimeComponents","parseInt","error","ConfigValidator","validateConfig","config","errors","field","message","severity","suggestion","value","isValid","hasCriticalErrors","hasWarnings","target_date","isValidDateInput","timer_entity","auto_discover_alexa","undefined","isValidEntityId","creation_date","isValidColorInput","isValidDimensionInput","aspect_ratio","isValidAspectRatioInput","stroke_width","isValidNumberInput","isValidBooleanInput","isValidTextInput","isValidStylesInput","_addHelpfulValidations","safeConfig","_generateSafeConfig","criticalErrors","filter","warnings","tomorrow","setDate","getDate","toISOString","background_color","progress_color","icon_size","validateConfigLegacy","result","join","isTemplate","date","pxMatch","px","percentMatch","percent","validUnits","unit","regex","unitValue","aspectMatch","width","height","Infinity","parsed","some","pattern","validStyleKeys","styleKeys","every","TemplateService","templateResults","templateCacheLimit","evaluateTemplate","template","cacheKey","cached","cacheTimeout","isDateTemplate","isValidTemplate","callApi","fallback","extractFallbackFromTemplate","enforceTemplateCacheLimit","innerTemplate","trim","simpleOrPattern","simpleOrMatch","chainedOrPattern","chainedMatch","conditionalPattern","conditionalMatch","reverseConditionalPattern","reverseMatch","keyword","resolveValue","_a","card","_b","clearTemplateCache","clear","cacheEntries","from","entries","sort","entriesToRemove","hasTemplatesInConfig","prop","escapeHtml","text","CountdownService","templateService","dateParser","timeRemaining","months","days","total","expired","updateCountdown","_timerDataToCountdownState","firstActiveTimer","find","targetDateValue","targetDate","difference","show_months","show_days","show_hours","show_minutes","show_seconds","totalMilliseconds","extraDays","extraHours","extraMinutes","extraSeconds","calculateProgress","creationDate","creationDateValue","totalDuration","getMainDisplay","label","getSubtitle","expired_text","part","shortUnit","charAt","getTimeRemaining","isExpired","getAvailableAlexaTimers","getCurrentTimerEntity","StyleManager","cache","dynamicIconSize","dynamicStrokeWidth","customStyles","lastConfigHash","processStyles","style","buildStylesObject","configHash","processedStyles","title","subtitle","progress_circle","_getCardDimensions","defaultWidth","defaultHeight","cardWidth","cardHeight","parseDimension","ratioW","ratioH","calculateDynamicIconSize","configKey","lastIconConfigHash","proportionalSize","baseSize","MIN_ICON_SIZE","MAX_ICON_SIZE","calculateDynamicStrokeWidth","iconSize","lastStrokeConfigHash","MIN_STROKE","MAX_STROKE","ratio","calculated","round","calculateProportionalSizes","defaultArea","scaleFactor","sqrt","titleSize","subtitleSize","dimension","dimStr","pixels","generateCardDimensionStyles","cardStyles","formattedWidth","_formatDimensionValue","formattedHeight","strValue","numValue","clearCache","getCardDimensions","_$Ct","_$Ci","hasAction","action","fireEvent","node","detail","event","CustomEvent","bubbles","cancelable","composed","dispatchEvent","createHandleAction","ev","actionConfig","tap_action","hold_action","double_tap_action","handleAction","actionHandlerDirective","directive","Directive","boundHandleStart","handleStart","bind","boundHandleEnd","handleEnd","boundHandleClick","handleClick","clickCount","isHolding","noChange","cleanup","setupListeners","preventDefault","stopPropagation","clearTimeouts","holdTimeout","clearTimeout","clickTimeout","hasHold","window","setTimeout","fireAction","hasDoubleClick","disconnected","ErrorDisplay","css","html","relevantErrors","property","customElements","define","TimeFlowCardBeta","getStubConfig","_resolvedConfig","_progress","_countdown","_expired","_validationResult","_initialized","_timerId","countdownService","styleManager","stubConfig","expired_animation","show_progress_text","setConfig","validationResult","_updateCountdownAndRender","then","err","_startCountdownUpdates","_stopCountdownUpdates","changedProperties","setInterval","clearInterval","resolvedConfig","templateKeys","resolvedValue","_renderCard","color","cardBackground","textColor","mainProgressColor","dynamicCircleSize","dynamicStroke","proportionalSizes","dimensionStyles","subtitleText","titleText","cardClasses","configWithDefaults","currentTimerEntity","hasActions","getCardSize","heightValue","version","ProgressCircleBeta","strokeWidth","showProgressText","changed","circle","querySelector","classList","updateProgress","animate","bar","transition","getProgress","safeProgress","stroke","radius","circumference","PI","offset","fontSize","customCards","description","preview","documentationURL"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,13]}